2026-01-18 17:11:45.509 + setup_drives
2026-01-18 17:11:45.510 + local idx=0
2026-01-18 17:11:45.512 + tee -a /dev/console
2026-01-18 17:11:45.513 ++ date
2026-01-18 17:11:45.515 + echo 'Drives setup started at: Sun' Jan 18 17:11:45 UTC 2026
2026-01-18 17:11:45.517 Drives setup started at: Sun Jan 18 17:11:45 UTC 2026
2026-01-18 17:11:45.518 + set -xe
2026-01-18 17:11:45.519 ++ find /usr/share/aws/emr/instance-controller/lib -name 'instance-controller*.jar' -and -not -name '*interface*'
2026-01-18 17:11:45.534 + local instance_controller_jar=/usr/share/aws/emr/instance-controller/lib/instance-controller-1.85.0.jar
2026-01-18 17:11:45.537 + '[' -e /var/setup-devices/device-names.json ']'
2026-01-18 17:11:45.538 ++ lsblk -pdno NAME
2026-01-18 17:11:45.539 ++ sort -V
2026-01-18 17:11:45.541 + local 'block_devices=/dev/nvme0n1
2026-01-18 17:11:45.542 /dev/nvme1n1
2026-01-18 17:11:45.543 /dev/nvme2n1'
2026-01-18 17:11:45.544 ++ cat /var/setup-devices/device-names.json
2026-01-18 17:11:45.545 ++ jq -r '.symlinkDevices | keys[]'
2026-01-18 17:11:45.546 ++ tr '\n' ' '
2026-01-18 17:11:45.557 + symlink_devices=('/dev/nvme0n1' '/dev/nvme2n1')
2026-01-18 17:11:45.558 + local symlink_devices
2026-01-18 17:11:45.559 ++ jq -r '.deviceNameRegex[]'
2026-01-18 17:11:45.560 ++ paste -s -d '|'
2026-01-18 17:11:45.570 + active_device_pattern='/dev/xvda2|/dev/nvme[0-9]+n1|/dev/xvd[b-z]+'
2026-01-18 17:11:45.571 + for symlink_device in ${symlink_devices[*]}
2026-01-18 17:11:45.572 ++ cat /var/setup-devices/device-names.json
2026-01-18 17:11:45.573 ++ jq -r '.symlinkDevices."/dev/nvme0n1"'
2026-01-18 17:11:45.574 + link_to_device=('/dev/xvda')
2026-01-18 17:11:45.576 + local link_to_device
2026-01-18 17:11:45.577 + symlink_root_device /dev/xvda /dev/nvme0n1
2026-01-18 17:11:45.578 + local root_device=/dev/xvda
2026-01-18 17:11:45.579 + local other_device=/dev/nvme0n1
2026-01-18 17:11:45.580 + '[' '!' -e /dev/xvda ']'
2026-01-18 17:11:45.581 + for symlink_device in ${symlink_devices[*]}
2026-01-18 17:11:45.582 ++ cat /var/setup-devices/device-names.json
2026-01-18 17:11:45.584 ++ jq -r '.symlinkDevices."/dev/nvme0n1"'
2026-01-18 17:11:45.585 + link_to_device=('/dev/xvda')
2026-01-18 17:11:45.586 + local link_to_device
2026-01-18 17:11:45.587 + symlink_root_device /dev/xvda /dev/nvme2n1
2026-01-18 17:11:45.589 + local root_device=/dev/xvda
2026-01-18 17:11:45.590 + local other_device=/dev/nvme2n1
2026-01-18 17:11:45.591 + '[' '!' -e /dev/xvda ']'
2026-01-18 17:11:45.592 + [[ ! -e /var/setup-devices/completed ]]
2026-01-18 17:11:45.593 + setup_cloud_cfg
2026-01-18 17:11:45.595 + cat
2026-01-18 17:11:45.596 + mv /tmp/00_emr.cfg /etc/cloud/cloud.cfg.d/
2026-01-18 17:11:45.597 
2026-01-18 17:11:45.598 real	0m0.004s
2026-01-18 17:11:45.600 user	0m0.003s
2026-01-18 17:11:45.601 sys	0m0.000s
2026-01-18 17:11:45.602 ++ ls /media/
2026-01-18 17:11:45.603 + active_devices=()
2026-01-18 17:11:45.604 + for device in $block_devices
2026-01-18 17:11:45.605 + is_swap_device /dev/nvme0n1
2026-01-18 17:11:45.606 + local device=/dev/nvme0n1
2026-01-18 17:11:45.607 + local return_code=0
2026-01-18 17:11:45.608 + swapon -s
2026-01-18 17:11:45.609 + grep -w /dev/nvme0n1
2026-01-18 17:11:45.610 + return_code=1
2026-01-18 17:11:45.611 + return 1
2026-01-18 17:11:45.612 ++ is_active_device /dev/nvme0n1
2026-01-18 17:11:45.613 ++ local device=/dev/nvme0n1
2026-01-18 17:11:45.614 ++ matches_active_device_pattern /dev/nvme0n1
2026-01-18 17:11:45.615 ++ local device=/dev/nvme0n1
2026-01-18 17:11:45.616 ++ echo /dev/nvme0n1
2026-01-18 17:11:45.617 ++ grep -qE '/dev/xvda2|/dev/nvme[0-9]+n1|/dev/xvd[b-z]+'
2026-01-18 17:11:45.618 ++ od -N 0 /dev/nvme0n1
2026-01-18 17:11:45.620 ++ '[' 0 == 0 ']'
2026-01-18 17:11:45.621 ++ echo true
2026-01-18 17:11:45.622 + '[' true '!=' true ']'
2026-01-18 17:11:45.623 ++ is_link_from_root_device /dev/xvda /dev/nvme0n1
2026-01-18 17:11:45.624 +++ readlink -f /dev/xvda
2026-01-18 17:11:45.625 ++ local root_device=/dev/nvme0n1
2026-01-18 17:11:45.626 ++ local this_device=/dev/nvme0n1
2026-01-18 17:11:45.627 ++ [[ /dev/nvme0n1 == \/\d\e\v\/\n\v\m\e\0\n\1 ]]
2026-01-18 17:11:45.628 ++ echo true
2026-01-18 17:11:45.629 + '[' true == true ']'
2026-01-18 17:11:45.630 + continue
2026-01-18 17:11:45.631 + for device in $block_devices
2026-01-18 17:11:45.632 + is_swap_device /dev/nvme1n1
2026-01-18 17:11:45.633 + local device=/dev/nvme1n1
2026-01-18 17:11:45.634 + local return_code=0
2026-01-18 17:11:45.635 + swapon -s
2026-01-18 17:11:45.636 + grep -w /dev/nvme1n1
2026-01-18 17:11:45.637 + return_code=1
2026-01-18 17:11:45.638 + return 1
2026-01-18 17:11:45.639 ++ is_active_device /dev/nvme1n1
2026-01-18 17:11:45.640 ++ local device=/dev/nvme1n1
2026-01-18 17:11:45.641 ++ matches_active_device_pattern /dev/nvme1n1
2026-01-18 17:11:45.642 ++ local device=/dev/nvme1n1
2026-01-18 17:11:45.643 ++ echo /dev/nvme1n1
2026-01-18 17:11:45.644 ++ grep -qE '/dev/xvda2|/dev/nvme[0-9]+n1|/dev/xvd[b-z]+'
2026-01-18 17:11:45.645 ++ od -N 0 /dev/nvme1n1
2026-01-18 17:11:45.646 ++ '[' 0 == 0 ']'
2026-01-18 17:11:45.647 ++ echo true
2026-01-18 17:11:45.648 + '[' true '!=' true ']'
2026-01-18 17:11:45.649 ++ is_link_from_root_device /dev/xvda /dev/nvme1n1
2026-01-18 17:11:45.650 +++ readlink -f /dev/xvda
2026-01-18 17:11:45.651 ++ local root_device=/dev/nvme0n1
2026-01-18 17:11:45.653 ++ local this_device=/dev/nvme1n1
2026-01-18 17:11:45.654 ++ [[ /dev/nvme0n1 == \/\d\e\v\/\n\v\m\e\1\n\1 ]]
2026-01-18 17:11:45.655 + '[' '' == true ']'
2026-01-18 17:11:45.656 + umount -f /dev/nvme1n1
2026-01-18 17:11:45.657 umount: /dev/nvme1n1: not mounted.
2026-01-18 17:11:45.658 + true
2026-01-18 17:11:45.659 + remove_fstab_entry /dev/nvme1n1
2026-01-18 17:11:45.662 + local deviceIdentifier=/dev/nvme1n1
2026-01-18 17:11:45.663 + grep -v /dev/nvme1n1 /etc/fstab
2026-01-18 17:11:45.664 + mv /tmp/fstab /etc/fstab
2026-01-18 17:11:45.665 + '[' 0 == 0 ']'
2026-01-18 17:11:45.666 + sgdisk -o -n 1:0:+5GB -N2 -p /dev/nvme1n1
2026-01-18 17:11:46.678 Creating new GPT entries in memory.
2026-01-18 17:11:46.680 Disk /dev/nvme1n1: 67108864 sectors, 32.0 GiB
2026-01-18 17:11:46.681 Model: Amazon Elastic Block Store              
2026-01-18 17:11:46.682 Sector size (logical/physical): 512/512 bytes
2026-01-18 17:11:46.684 Disk identifier (GUID): 939918DF-08C1-4BAB-B759-80E1B54D3917
2026-01-18 17:11:46.685 Partition table holds up to 128 entries
2026-01-18 17:11:46.686 Main partition table begins at sector 2 and ends at sector 33
2026-01-18 17:11:46.688 First usable sector is 34, last usable sector is 67108830
2026-01-18 17:11:46.689 Partitions will be aligned on 2048-sector boundaries
2026-01-18 17:11:46.690 Total free space is 2014 sectors (1007.0 KiB)
2026-01-18 17:11:46.691 
2026-01-18 17:11:46.693 Number  Start (sector)    End (sector)  Size       Code  Name
2026-01-18 17:11:46.694    1            2048        10487807   5.0 GiB     8300  
2026-01-18 17:11:46.695    2        10487808        67108830   27.0 GiB    8300  
2026-01-18 17:11:46.696 The operation has completed successfully.
2026-01-18 17:11:46.697 + active_devices=($(ls -1 $device?*))
2026-01-18 17:11:46.698 ++ ls -1 /dev/nvme1n1p1 /dev/nvme1n1p2
2026-01-18 17:11:46.699 + (( idx = idx + 1 ))
2026-01-18 17:11:46.700 + for device in $block_devices
2026-01-18 17:11:46.701 + is_swap_device /dev/nvme2n1
2026-01-18 17:11:46.702 + local device=/dev/nvme2n1
2026-01-18 17:11:46.703 + local return_code=0
2026-01-18 17:11:46.704 + swapon -s
2026-01-18 17:11:46.705 + grep -w /dev/nvme2n1
2026-01-18 17:11:46.706 + return_code=1
2026-01-18 17:11:46.707 + return 1
2026-01-18 17:11:46.708 ++ is_active_device /dev/nvme2n1
2026-01-18 17:11:46.709 ++ local device=/dev/nvme2n1
2026-01-18 17:11:46.710 ++ matches_active_device_pattern /dev/nvme2n1
2026-01-18 17:11:46.711 ++ local device=/dev/nvme2n1
2026-01-18 17:11:46.712 ++ echo /dev/nvme2n1
2026-01-18 17:11:46.714 ++ grep -qE '/dev/xvda2|/dev/nvme[0-9]+n1|/dev/xvd[b-z]+'
2026-01-18 17:11:46.715 ++ od -N 0 /dev/nvme2n1
2026-01-18 17:11:46.716 ++ '[' 0 == 0 ']'
2026-01-18 17:11:46.717 ++ echo true
2026-01-18 17:11:46.718 + '[' true '!=' true ']'
2026-01-18 17:11:46.719 ++ is_link_from_root_device /dev/xvda /dev/nvme2n1
2026-01-18 17:11:46.720 +++ readlink -f /dev/xvda
2026-01-18 17:11:46.721 ++ local root_device=/dev/nvme0n1
2026-01-18 17:11:46.722 ++ local this_device=/dev/nvme2n1
2026-01-18 17:11:46.723 ++ [[ /dev/nvme0n1 == \/\d\e\v\/\n\v\m\e\2\n\1 ]]
2026-01-18 17:11:46.724 + '[' '' == true ']'
2026-01-18 17:11:46.725 + umount -f /dev/nvme2n1
2026-01-18 17:11:46.726 umount: /dev/nvme2n1: not mounted.
2026-01-18 17:11:46.727 + true
2026-01-18 17:11:46.728 + remove_fstab_entry /dev/nvme2n1
2026-01-18 17:11:46.729 + local deviceIdentifier=/dev/nvme2n1
2026-01-18 17:11:46.730 + grep -v /dev/nvme2n1 /etc/fstab
2026-01-18 17:11:46.731 + mv /tmp/fstab /etc/fstab
2026-01-18 17:11:46.732 + '[' 1 == 0 ']'
2026-01-18 17:11:46.734 + active_devices+=($device)
2026-01-18 17:11:46.735 + (( idx = idx + 1 ))
2026-01-18 17:11:46.737 + encrypted_devices=($($INSTANCE_CONTROLLER_JAVA/java -cp $DISK_ENCRYPTOR_CP -Dlog4j2.configurationFile=file:$DISK_ENCRYPTOR_LOG4J2_CONFIG -Dlog4j2.formatMsgNoLookups=true -Dlog4j2.disable.jmx=true aws157.instancecontroller.encryptor.DiskEncryptorMain ${active_devices[*]}))
2026-01-18 17:11:46.738 ++ /usr/lib/jvm/jre-17/bin/java -cp '/usr/share/aws/emr/instance-controller/lib/*:/var/setup-devices/lib/*:/home/hadoop/conf:/usr/share/aws/aws-java-sdk-v2/*' -Dlog4j2.configurationFile=file:/etc/instance-controller/disk-encryptor-log4j2.xml -Dlog4j2.formatMsgNoLookups=true -Dlog4j2.disable.jmx=true aws157.instancecontroller.encryptor.DiskEncryptorMain /dev/nvme1n1p1 /dev/nvme1n1p2 /dev/nvme2n1
2026-01-18 17:11:51.754 SLF4J: Failed to load class "org.slf4j.impl.StaticLoggerBinder".
2026-01-18 17:11:51.756 SLF4J: Defaulting to no-operation (NOP) logger implementation
2026-01-18 17:11:51.757 SLF4J: See http://www.slf4j.org/codes.html#StaticLoggerBinder for further details.
2026-01-18 17:11:52.181 + make_xfs_parallel /dev/nvme1n1p1 /dev/nvme1n1p2 /dev/nvme2n1
2026-01-18 17:11:52.183 ++ printf '%s\n' /dev/nvme1n1p1 /dev/nvme1n1p2 /dev/nvme2n1
2026-01-18 17:11:52.184 + local 'devices=/dev/nvme1n1p1
2026-01-18 17:11:52.185 /dev/nvme1n1p2
2026-01-18 17:11:52.187 /dev/nvme2n1'
2026-01-18 17:11:52.188 ++ run_repeatedly 3 mktemp -t make_xfs_XXXXXXXXXX
2026-01-18 17:11:52.190 ++ (( i = 0 ))
2026-01-18 17:11:52.191 ++ (( i < 3 ))
2026-01-18 17:11:52.193 ++ mktemp -t make_xfs_XXXXXXXXXX
2026-01-18 17:11:52.194 ++ (( i++ ))
2026-01-18 17:11:52.195 ++ (( i < 3 ))
2026-01-18 17:11:52.196 ++ mktemp -t make_xfs_XXXXXXXXXX
2026-01-18 17:11:52.197 ++ (( i++ ))
2026-01-18 17:11:52.198 ++ (( i < 3 ))
2026-01-18 17:11:52.199 ++ mktemp -t make_xfs_XXXXXXXXXX
2026-01-18 17:11:52.200 ++ (( i++ ))
2026-01-18 17:11:52.201 ++ (( i < 3 ))
2026-01-18 17:11:52.202 + local 'log_files=/tmp/make_xfs_6VeFcGAHrB
2026-01-18 17:11:52.203 /tmp/make_xfs_7qc7MXHEi4
2026-01-18 17:11:52.204 /tmp/make_xfs_Gl1nInVBAS'
2026-01-18 17:11:52.206 + local return_code=0
2026-01-18 17:11:52.207 + run_make_xfs_parallel '/dev/nvme1n1p1
2026-01-18 17:11:52.208 /dev/nvme1n1p2
2026-01-18 17:11:52.209 /dev/nvme2n1' '/tmp/make_xfs_6VeFcGAHrB
2026-01-18 17:11:52.210 /tmp/make_xfs_7qc7MXHEi4
2026-01-18 17:11:52.211 /tmp/make_xfs_Gl1nInVBAS'
2026-01-18 17:11:52.213 + timeout --kill-after=10 10 bash -c '{ date; udevadm monitor; }'
2026-01-18 17:11:52.214 + local 'devices=/dev/nvme1n1p1
2026-01-18 17:11:52.215 /dev/nvme1n1p2
2026-01-18 17:11:52.216 /dev/nvme2n1'
2026-01-18 17:11:52.217 + local 'log_files=/tmp/make_xfs_6VeFcGAHrB
2026-01-18 17:11:52.218 /tmp/make_xfs_7qc7MXHEi4
2026-01-18 17:11:52.219 /tmp/make_xfs_Gl1nInVBAS'
2026-01-18 17:11:52.220 + interleave_lines '/dev/nvme1n1p1
2026-01-18 17:11:52.221 /dev/nvme1n1p2
2026-01-18 17:11:52.222 /dev/nvme2n1' '/tmp/make_xfs_6VeFcGAHrB
2026-01-18 17:11:52.223 /tmp/make_xfs_7qc7MXHEi4
2026-01-18 17:11:52.224 /tmp/make_xfs_Gl1nInVBAS'
2026-01-18 17:11:52.225 ++ date +%Y-%m-%d-%H-%M-%S
2026-01-18 17:11:52.226 + xargs -r --verbose -P0 -L2 bash -xc '
2026-01-18 17:11:52.227       device=$0; log_file=$1
2026-01-18 17:11:52.229       { time mkfs.xfs -f "$device"; exit $?; } > "$log_file" 2>&1'
2026-01-18 17:11:52.230 + paste '-d\n' /dev/fd/63 /dev/fd/62
2026-01-18 17:11:52.231 ++ echo '/dev/nvme1n1p1
2026-01-18 17:11:52.232 /dev/nvme1n1p2
2026-01-18 17:11:52.233 /dev/nvme2n1'
2026-01-18 17:11:52.234 ++ echo '/tmp/make_xfs_6VeFcGAHrB
2026-01-18 17:11:52.235 /tmp/make_xfs_7qc7MXHEi4
2026-01-18 17:11:52.236 /tmp/make_xfs_Gl1nInVBAS'
2026-01-18 17:11:52.237 bash -xc ''$'\n''      device=$0; log_file=$1'$'\n''      { time mkfs.xfs -f "$device"; exit $?; } > "$log_file" 2>&1' /dev/nvme1n1p1 /tmp/make_xfs_6VeFcGAHrB
2026-01-18 17:11:52.238 bash -xc ''$'\n''      device=$0; log_file=$1'$'\n''      { time mkfs.xfs -f "$device"; exit $?; } > "$log_file" 2>&1' /dev/nvme1n1p2 /tmp/make_xfs_7qc7MXHEi4
2026-01-18 17:11:52.239 bash -xc ''$'\n''      device=$0; log_file=$1'$'\n''      { time mkfs.xfs -f "$device"; exit $?; } > "$log_file" 2>&1' /dev/nvme2n1 /tmp/make_xfs_Gl1nInVBAS
2026-01-18 17:11:52.240 + device=/dev/nvme1n1p1
2026-01-18 17:11:52.241 + log_file=/tmp/make_xfs_6VeFcGAHrB
2026-01-18 17:11:52.242 + device=/dev/nvme1n1p2
2026-01-18 17:11:52.243 + log_file=/tmp/make_xfs_7qc7MXHEi4
2026-01-18 17:11:52.244 + device=/dev/nvme2n1
2026-01-18 17:11:52.245 + log_file=/tmp/make_xfs_Gl1nInVBAS
2026-01-18 17:11:52.644 + echo 'Waiting for udev to settle'
2026-01-18 17:11:52.646 Waiting for udev to settle
2026-01-18 17:11:52.647 + udevadm settle
2026-01-18 17:11:52.718 + echo 'udevadmn settle finished'
2026-01-18 17:11:52.719 udevadmn settle finished
2026-01-18 17:11:52.720 + process_log_files '/tmp/make_xfs_6VeFcGAHrB
2026-01-18 17:11:52.721 /tmp/make_xfs_7qc7MXHEi4
2026-01-18 17:11:52.722 /tmp/make_xfs_Gl1nInVBAS'
2026-01-18 17:11:52.723 + '[' -n '/tmp/make_xfs_6VeFcGAHrB
2026-01-18 17:11:52.725 /tmp/make_xfs_7qc7MXHEi4
2026-01-18 17:11:52.726 /tmp/make_xfs_Gl1nInVBAS' ']'
2026-01-18 17:11:52.727 + read -r log_file
2026-01-18 17:11:52.728 + echo '/tmp/make_xfs_6VeFcGAHrB
2026-01-18 17:11:52.729 /tmp/make_xfs_7qc7MXHEi4
2026-01-18 17:11:52.730 /tmp/make_xfs_Gl1nInVBAS'
2026-01-18 17:11:52.731 + sed 's#^#    #' /tmp/make_xfs_6VeFcGAHrB
2026-01-18 17:11:52.732     + mkfs.xfs -f /dev/nvme1n1p1
2026-01-18 17:11:52.734     meta-data=/dev/nvme1n1p1         isize=512    agcount=8, agsize=163840 blks
2026-01-18 17:11:52.735              =                       sectsz=512   attr=2, projid32bit=1
2026-01-18 17:11:52.736              =                       crc=1        finobt=1, sparse=1, rmapbt=0
2026-01-18 17:11:52.737              =                       reflink=1    bigtime=1 inobtcount=1 nrext64=0
2026-01-18 17:11:52.738              =                       exchange=0  
2026-01-18 17:11:52.740     data     =                       bsize=4096   blocks=1310720, imaxpct=25
2026-01-18 17:11:52.741              =                       sunit=1      swidth=1 blks
2026-01-18 17:11:52.742     naming   =version 2              bsize=4096   ascii-ci=0, ftype=1, parent=0
2026-01-18 17:11:52.743     log      =internal log           bsize=4096   blocks=16384, version=2
2026-01-18 17:11:52.744              =                       sectsz=512   sunit=1 blks, lazy-count=1
2026-01-18 17:11:52.745     realtime =none                   extsz=4096   blocks=0, rtextents=0
2026-01-18 17:11:52.746     
2026-01-18 17:11:52.747     real	0m0.365s
2026-01-18 17:11:52.748     user	0m0.003s
2026-01-18 17:11:52.749     sys	0m0.005s
2026-01-18 17:11:52.750     + exit 0
2026-01-18 17:11:52.751 + rm /tmp/make_xfs_6VeFcGAHrB
2026-01-18 17:11:52.752 + read -r log_file
2026-01-18 17:11:52.753 + sed 's#^#    #' /tmp/make_xfs_7qc7MXHEi4
2026-01-18 17:11:52.754     + mkfs.xfs -f /dev/nvme1n1p2
2026-01-18 17:11:52.755     meta-data=/dev/nvme1n1p2         isize=512    agcount=16, agsize=442352 blks
2026-01-18 17:11:52.757              =                       sectsz=512   attr=2, projid32bit=1
2026-01-18 17:11:52.758              =                       crc=1        finobt=1, sparse=1, rmapbt=0
2026-01-18 17:11:52.759              =                       reflink=1    bigtime=1 inobtcount=1 nrext64=0
2026-01-18 17:11:52.760              =                       exchange=0  
2026-01-18 17:11:52.761     data     =                       bsize=4096   blocks=7077627, imaxpct=25
2026-01-18 17:11:52.762              =                       sunit=1      swidth=1 blks
2026-01-18 17:11:52.763     naming   =version 2              bsize=4096   ascii-ci=0, ftype=1, parent=0
2026-01-18 17:11:52.764     log      =internal log           bsize=4096   blocks=16384, version=2
2026-01-18 17:11:52.765              =                       sectsz=512   sunit=1 blks, lazy-count=1
2026-01-18 17:11:52.766     realtime =none                   extsz=4096   blocks=0, rtextents=0
2026-01-18 17:11:52.767     
2026-01-18 17:11:52.768     real	0m0.452s
2026-01-18 17:11:52.769     user	0m0.000s
2026-01-18 17:11:52.770     sys	0m0.009s
2026-01-18 17:11:52.771     + exit 0
2026-01-18 17:11:52.772 + rm /tmp/make_xfs_7qc7MXHEi4
2026-01-18 17:11:52.773 + read -r log_file
2026-01-18 17:11:52.774 + sed 's#^#    #' /tmp/make_xfs_Gl1nInVBAS
2026-01-18 17:11:52.775     + mkfs.xfs -f /dev/nvme2n1
2026-01-18 17:11:52.776     meta-data=/dev/nvme2n1           isize=512    agcount=16, agsize=524288 blks
2026-01-18 17:11:52.777              =                       sectsz=512   attr=2, projid32bit=1
2026-01-18 17:11:52.778              =                       crc=1        finobt=1, sparse=1, rmapbt=0
2026-01-18 17:11:52.780              =                       reflink=1    bigtime=1 inobtcount=1 nrext64=0
2026-01-18 17:11:52.781              =                       exchange=0  
2026-01-18 17:11:52.782     data     =                       bsize=4096   blocks=8388608, imaxpct=25
2026-01-18 17:11:52.783              =                       sunit=1      swidth=1 blks
2026-01-18 17:11:52.784     naming   =version 2              bsize=4096   ascii-ci=0, ftype=1, parent=0
2026-01-18 17:11:52.785     log      =internal log           bsize=4096   blocks=16384, version=2
2026-01-18 17:11:52.786              =                       sectsz=512   sunit=1 blks, lazy-count=1
2026-01-18 17:11:52.787     realtime =none                   extsz=4096   blocks=0, rtextents=0
2026-01-18 17:11:52.789     
2026-01-18 17:11:52.790     real	0m0.391s
2026-01-18 17:11:52.791     user	0m0.004s
2026-01-18 17:11:52.792     sys	0m0.004s
2026-01-18 17:11:52.793     + exit 0
2026-01-18 17:11:52.794 + rm /tmp/make_xfs_Gl1nInVBAS
2026-01-18 17:11:52.795 + read -r log_file
2026-01-18 17:11:52.796 + return 0
2026-01-18 17:11:52.797 + emrDevice=/dev/nvme1n1p1
2026-01-18 17:11:52.799 + encrypted_devices=("${encrypted_devices[@]:1}")
2026-01-18 17:11:52.800 + create_devices_mount_map /dev/nvme1n1p1 /emr
2026-01-18 17:11:52.801 + local deviceFile=/dev/nvme1n1p1
2026-01-18 17:11:52.803 + local mount_point=/emr
2026-01-18 17:11:52.804 + echo /dev/nvme1n1p1
2026-01-18 17:11:52.805 + grep -qs /mapper
2026-01-18 17:11:52.806 ++ repeat_command_until_not_empty 'lsblk -o UUID -ipnd /dev/nvme1n1p1' 5
2026-01-18 17:11:52.807 ++ local 'cmd=lsblk -o UUID -ipnd /dev/nvme1n1p1'
2026-01-18 17:11:52.809 ++ local maxWait=5
2026-01-18 17:11:52.810 ++ local result=
2026-01-18 17:11:52.811 +++ date +%s
2026-01-18 17:11:52.812 ++ endTime=1768756317
2026-01-18 17:11:52.813 ++ '[' -z ']'
2026-01-18 17:11:52.814 +++ date +%s
2026-01-18 17:11:52.815 ++ '[' 1768756312 -lt 1768756317 ']'
2026-01-18 17:11:52.817 +++ bash -c 'lsblk -o UUID -ipnd /dev/nvme1n1p1'
2026-01-18 17:11:52.818 ++ result=9969ff04-d4db-422a-9f75-3b824d1e5f47
2026-01-18 17:11:52.819 ++ '[' -z 9969ff04-d4db-422a-9f75-3b824d1e5f47 ']'
2026-01-18 17:11:52.820 ++ printf 9969ff04-d4db-422a-9f75-3b824d1e5f47
2026-01-18 17:11:52.821 + local deviceUUID=9969ff04-d4db-422a-9f75-3b824d1e5f47
2026-01-18 17:11:52.822 + '[' -z 9969ff04-d4db-422a-9f75-3b824d1e5f47 ']'
2026-01-18 17:11:52.823 + create_drive 9969ff04-d4db-422a-9f75-3b824d1e5f47 /emr
2026-01-18 17:11:52.824 + local deviceUUID=9969ff04-d4db-422a-9f75-3b824d1e5f47
2026-01-18 17:11:52.825 + local drive=/emr
2026-01-18 17:11:52.826 + create_directory /emr
2026-01-18 17:11:52.827 + local dir=/emr
2026-01-18 17:11:52.828 + '[' -d /emr ']'
2026-01-18 17:11:52.829 + '[' -d /emr ']'
2026-01-18 17:11:52.830 + mount_drive 9969ff04-d4db-422a-9f75-3b824d1e5f47 /emr
2026-01-18 17:11:52.831 + local deviceUUID=9969ff04-d4db-422a-9f75-3b824d1e5f47
2026-01-18 17:11:52.832 + local mountPoint=/emr
2026-01-18 17:11:52.833 + lsblk -o UUID,MOUNTPOINT -ipnr
2026-01-18 17:11:52.834 + grep -
2026-01-18 17:11:52.835 + grep -qs '^9969ff04-d4db-422a-9f75-3b824d1e5f47 /emr$'
2026-01-18 17:11:52.837 + [[ /emr == \/\e\m\r ]]
2026-01-18 17:11:52.838 + mount -o inode64,nodev -t xfs UUID=9969ff04-d4db-422a-9f75-3b824d1e5f47 /emr
2026-01-18 17:11:52.839 + remove_fstab_entry 9969ff04-d4db-422a-9f75-3b824d1e5f47
2026-01-18 17:11:52.840 + local deviceIdentifier=9969ff04-d4db-422a-9f75-3b824d1e5f47
2026-01-18 17:11:52.841 + grep -v 9969ff04-d4db-422a-9f75-3b824d1e5f47 /etc/fstab
2026-01-18 17:11:52.842 + mv /tmp/fstab /etc/fstab
2026-01-18 17:11:52.843 + echo 'UUID=9969ff04-d4db-422a-9f75-3b824d1e5f47 /emr xfs defaults,noauto,comment=emr-setup-devices 0 0'
2026-01-18 17:11:52.844 + echo '9969ff04-d4db-422a-9f75-3b824d1e5f47 /emr'
2026-01-18 17:11:52.845 + mntDevice=/dev/nvme1n1p2
2026-01-18 17:11:52.846 + encrypted_devices=("${encrypted_devices[@]:1}")
2026-01-18 17:11:52.847 + create_devices_mount_map /dev/nvme1n1p2 /mnt
2026-01-18 17:11:52.848 + local deviceFile=/dev/nvme1n1p2
2026-01-18 17:11:52.849 + local mount_point=/mnt
2026-01-18 17:11:52.850 + echo /dev/nvme1n1p2
2026-01-18 17:11:52.851 + grep -qs /mapper
2026-01-18 17:11:52.852 ++ repeat_command_until_not_empty 'lsblk -o UUID -ipnd /dev/nvme1n1p2' 5
2026-01-18 17:11:52.853 ++ local 'cmd=lsblk -o UUID -ipnd /dev/nvme1n1p2'
2026-01-18 17:11:52.854 ++ local maxWait=5
2026-01-18 17:11:52.855 ++ local result=
2026-01-18 17:11:52.857 +++ date +%s
2026-01-18 17:11:52.858 ++ endTime=1768756317
2026-01-18 17:11:52.859 ++ '[' -z ']'
2026-01-18 17:11:52.860 +++ date +%s
2026-01-18 17:11:52.861 ++ '[' 1768756312 -lt 1768756317 ']'
2026-01-18 17:11:52.862 +++ bash -c 'lsblk -o UUID -ipnd /dev/nvme1n1p2'
2026-01-18 17:11:52.863 ++ result=59ccff6d-e19c-4450-9a00-cd7fc6642ced
2026-01-18 17:11:52.864 ++ '[' -z 59ccff6d-e19c-4450-9a00-cd7fc6642ced ']'
2026-01-18 17:11:52.865 ++ printf 59ccff6d-e19c-4450-9a00-cd7fc6642ced
2026-01-18 17:11:52.866 + local deviceUUID=59ccff6d-e19c-4450-9a00-cd7fc6642ced
2026-01-18 17:11:52.867 + '[' -z 59ccff6d-e19c-4450-9a00-cd7fc6642ced ']'
2026-01-18 17:11:52.869 + create_drive 59ccff6d-e19c-4450-9a00-cd7fc6642ced /mnt
2026-01-18 17:11:52.870 + local deviceUUID=59ccff6d-e19c-4450-9a00-cd7fc6642ced
2026-01-18 17:11:52.871 + local drive=/mnt
2026-01-18 17:11:52.872 + create_directory /mnt
2026-01-18 17:11:52.873 + local dir=/mnt
2026-01-18 17:11:52.874 + '[' -d /mnt ']'
2026-01-18 17:11:52.875 + '[' -d /mnt ']'
2026-01-18 17:11:52.876 + mount_drive 59ccff6d-e19c-4450-9a00-cd7fc6642ced /mnt
2026-01-18 17:11:52.877 + local deviceUUID=59ccff6d-e19c-4450-9a00-cd7fc6642ced
2026-01-18 17:11:52.879 + local mountPoint=/mnt
2026-01-18 17:11:52.880 + lsblk -o UUID,MOUNTPOINT -ipnr
2026-01-18 17:11:52.881 + grep -
2026-01-18 17:11:52.882 + grep -qs '^59ccff6d-e19c-4450-9a00-cd7fc6642ced /mnt$'
2026-01-18 17:11:52.883 + [[ /mnt == \/\e\m\r ]]
2026-01-18 17:11:52.885 + mount -o inode64,nodev,usrquota,grpquota,prjquota -t xfs UUID=59ccff6d-e19c-4450-9a00-cd7fc6642ced /mnt
2026-01-18 17:11:52.886 + remove_fstab_entry 59ccff6d-e19c-4450-9a00-cd7fc6642ced
2026-01-18 17:11:52.887 + local deviceIdentifier=59ccff6d-e19c-4450-9a00-cd7fc6642ced
2026-01-18 17:11:52.888 + grep -v 59ccff6d-e19c-4450-9a00-cd7fc6642ced /etc/fstab
2026-01-18 17:11:52.889 + mv /tmp/fstab /etc/fstab
2026-01-18 17:11:52.891 + echo 'UUID=59ccff6d-e19c-4450-9a00-cd7fc6642ced /mnt xfs defaults,noauto,comment=emr-setup-devices 0 0'
2026-01-18 17:11:52.892 + echo '59ccff6d-e19c-4450-9a00-cd7fc6642ced /mnt'
2026-01-18 17:11:52.893 + deviceIdx=1
2026-01-18 17:11:52.894 + for dev in "${encrypted_devices[@]}"
2026-01-18 17:11:52.895 + create_devices_mount_map /dev/nvme2n1 /mnt1
2026-01-18 17:11:52.896 + local deviceFile=/dev/nvme2n1
2026-01-18 17:11:52.897 + local mount_point=/mnt1
2026-01-18 17:11:52.898 + echo /dev/nvme2n1
2026-01-18 17:11:52.899 + grep -qs /mapper
2026-01-18 17:11:52.900 ++ repeat_command_until_not_empty 'lsblk -o UUID -ipnd /dev/nvme2n1' 5
2026-01-18 17:11:52.902 ++ local 'cmd=lsblk -o UUID -ipnd /dev/nvme2n1'
2026-01-18 17:11:52.903 ++ local maxWait=5
2026-01-18 17:11:52.904 ++ local result=
2026-01-18 17:11:52.905 +++ date +%s
2026-01-18 17:11:52.906 ++ endTime=1768756317
2026-01-18 17:11:52.907 ++ '[' -z ']'
2026-01-18 17:11:52.908 +++ date +%s
2026-01-18 17:11:52.909 ++ '[' 1768756312 -lt 1768756317 ']'
2026-01-18 17:11:52.910 +++ bash -c 'lsblk -o UUID -ipnd /dev/nvme2n1'
2026-01-18 17:11:52.911 ++ result=a9f550bd-49e4-4325-b007-7a4b7ec34315
2026-01-18 17:11:52.912 ++ '[' -z a9f550bd-49e4-4325-b007-7a4b7ec34315 ']'
2026-01-18 17:11:52.913 ++ printf a9f550bd-49e4-4325-b007-7a4b7ec34315
2026-01-18 17:11:52.914 + local deviceUUID=a9f550bd-49e4-4325-b007-7a4b7ec34315
2026-01-18 17:11:52.915 + '[' -z a9f550bd-49e4-4325-b007-7a4b7ec34315 ']'
2026-01-18 17:11:52.916 + create_drive a9f550bd-49e4-4325-b007-7a4b7ec34315 /mnt1
2026-01-18 17:11:52.918 + local deviceUUID=a9f550bd-49e4-4325-b007-7a4b7ec34315
2026-01-18 17:11:52.919 + local drive=/mnt1
2026-01-18 17:11:52.920 + create_directory /mnt1
2026-01-18 17:11:52.921 + local dir=/mnt1
2026-01-18 17:11:52.922 + '[' -d /mnt1 ']'
2026-01-18 17:11:52.923 + mkdir -p /mnt1
2026-01-18 17:11:52.924 + '[' -d /mnt1 ']'
2026-01-18 17:11:52.925 + mount_drive a9f550bd-49e4-4325-b007-7a4b7ec34315 /mnt1
2026-01-18 17:11:52.926 + local deviceUUID=a9f550bd-49e4-4325-b007-7a4b7ec34315
2026-01-18 17:11:52.927 + local mountPoint=/mnt1
2026-01-18 17:11:52.928 + lsblk -o UUID,MOUNTPOINT -ipnr
2026-01-18 17:11:52.929 + grep -
2026-01-18 17:11:52.930 + grep -qs '^a9f550bd-49e4-4325-b007-7a4b7ec34315 /mnt1$'
2026-01-18 17:11:52.931 + [[ /mnt1 == \/\e\m\r ]]
2026-01-18 17:11:52.932 + mount -o inode64,nodev,usrquota,grpquota,prjquota -t xfs UUID=a9f550bd-49e4-4325-b007-7a4b7ec34315 /mnt1
2026-01-18 17:11:52.958 + remove_fstab_entry a9f550bd-49e4-4325-b007-7a4b7ec34315
2026-01-18 17:11:52.959 + local deviceIdentifier=a9f550bd-49e4-4325-b007-7a4b7ec34315
2026-01-18 17:11:52.960 + grep -v a9f550bd-49e4-4325-b007-7a4b7ec34315 /etc/fstab
2026-01-18 17:11:52.962 + mv /tmp/fstab /etc/fstab
2026-01-18 17:11:52.963 + echo 'UUID=a9f550bd-49e4-4325-b007-7a4b7ec34315 /mnt1 xfs defaults,noauto,comment=emr-setup-devices 0 0'
2026-01-18 17:11:52.964 + echo 'a9f550bd-49e4-4325-b007-7a4b7ec34315 /mnt1'
2026-01-18 17:11:52.965 + (( deviceIdx = deviceIdx + 1 ))
2026-01-18 17:11:52.967 + tee -a /dev/console
2026-01-18 17:11:52.968 ++ date
2026-01-18 17:11:52.972 + echo 'Drives setup completed at: Sun' Jan 18 17:11:52 UTC 2026
2026-01-18 17:11:52.973 Drives setup completed at: Sun Jan 18 17:11:52 UTC 2026
2026-01-18 17:11:52.974 + echo 'Currently mounted devices: '
2026-01-18 17:11:52.975 + tee -a /dev/console
2026-01-18 17:11:52.976 Currently mounted devices: 
2026-01-18 17:11:52.977 + df
2026-01-18 17:11:52.978 + tee -a /dev/console
2026-01-18 17:11:52.979 Filesystem       1K-blocks    Used Available Use% Mounted on
2026-01-18 17:11:52.980 devtmpfs              4096       0      4096   0% /dev
2026-01-18 17:11:52.981 tmpfs              8078908       0   8078908   0% /dev/shm
2026-01-18 17:11:52.983 tmpfs              3231564    8604   3222960   1% /run
2026-01-18 17:11:52.984 /dev/nvme0n1p1    15650796 7156052   8494744  46% /
2026-01-18 17:11:52.985 /dev/nvme0n1p128     10202    1314      8888  13% /boot/efi
2026-01-18 17:11:52.986 /dev/nvme1n1p1     5177344   69368   5107976   2% /emr
2026-01-18 17:11:52.987 /dev/nvme1n1p2    28244972  230756  28014216   1% /mnt
2026-01-18 17:11:52.988 /dev/nvme2n1      33488896  267356  33221540   1% /mnt1
2026-01-18 17:11:52.989 
2026-01-18 17:11:52.990 real	0m7.469s
2026-01-18 17:11:52.991 user	0m2.981s
2026-01-18 17:11:52.992 sys	0m0.178s
