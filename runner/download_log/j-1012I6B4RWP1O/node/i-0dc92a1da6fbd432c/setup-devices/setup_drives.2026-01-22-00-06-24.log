2026-01-22 00:06:24.219 + setup_drives
2026-01-22 00:06:24.221 + local idx=0
2026-01-22 00:06:24.223 + tee -a /dev/console
2026-01-22 00:06:24.225 ++ date
2026-01-22 00:06:24.226 + echo 'Drives setup started at: Thu' Jan 22 00:06:24 UTC 2026
2026-01-22 00:06:24.228 Drives setup started at: Thu Jan 22 00:06:24 UTC 2026
2026-01-22 00:06:24.229 + set -xe
2026-01-22 00:06:24.230 ++ find /usr/share/aws/emr/instance-controller/lib -name 'instance-controller*.jar' -and -not -name '*interface*'
2026-01-22 00:06:24.243 + local instance_controller_jar=/usr/share/aws/emr/instance-controller/lib/instance-controller-1.85.0.jar
2026-01-22 00:06:24.244 + '[' -e /var/setup-devices/device-names.json ']'
2026-01-22 00:06:24.245 ++ lsblk -pdno NAME
2026-01-22 00:06:24.246 ++ sort -V
2026-01-22 00:06:24.259 + local 'block_devices=/dev/nvme0n1
2026-01-22 00:06:24.260 /dev/nvme1n1
2026-01-22 00:06:24.261 /dev/nvme2n1'
2026-01-22 00:06:24.262 ++ cat /var/setup-devices/device-names.json
2026-01-22 00:06:24.263 ++ jq -r '.symlinkDevices | keys[]'
2026-01-22 00:06:24.264 ++ tr '\n' ' '
2026-01-22 00:06:24.276 + symlink_devices=('/dev/nvme0n1' '/dev/nvme2n1')
2026-01-22 00:06:24.277 + local symlink_devices
2026-01-22 00:06:24.278 ++ paste -s -d '|'
2026-01-22 00:06:24.280 ++ jq -r '.deviceNameRegex[]'
2026-01-22 00:06:24.290 + active_device_pattern='/dev/xvda2|/dev/nvme[0-9]+n1|/dev/xvd[b-z]+'
2026-01-22 00:06:24.291 + for symlink_device in ${symlink_devices[*]}
2026-01-22 00:06:24.292 ++ cat /var/setup-devices/device-names.json
2026-01-22 00:06:24.293 ++ jq -r '.symlinkDevices."/dev/nvme0n1"'
2026-01-22 00:06:24.294 + link_to_device=('/dev/xvda')
2026-01-22 00:06:24.295 + local link_to_device
2026-01-22 00:06:24.297 + symlink_root_device /dev/xvda /dev/nvme0n1
2026-01-22 00:06:24.298 + local root_device=/dev/xvda
2026-01-22 00:06:24.299 + local other_device=/dev/nvme0n1
2026-01-22 00:06:24.301 + '[' '!' -e /dev/xvda ']'
2026-01-22 00:06:24.302 + for symlink_device in ${symlink_devices[*]}
2026-01-22 00:06:24.303 ++ cat /var/setup-devices/device-names.json
2026-01-22 00:06:24.304 ++ jq -r '.symlinkDevices."/dev/nvme0n1"'
2026-01-22 00:06:24.305 + link_to_device=('/dev/xvda')
2026-01-22 00:06:24.306 + local link_to_device
2026-01-22 00:06:24.308 + symlink_root_device /dev/xvda /dev/nvme2n1
2026-01-22 00:06:24.309 + local root_device=/dev/xvda
2026-01-22 00:06:24.310 + local other_device=/dev/nvme2n1
2026-01-22 00:06:24.311 + '[' '!' -e /dev/xvda ']'
2026-01-22 00:06:24.312 + [[ ! -e /var/setup-devices/completed ]]
2026-01-22 00:06:24.313 + setup_cloud_cfg
2026-01-22 00:06:24.315 + cat
2026-01-22 00:06:24.316 + mv /tmp/00_emr.cfg /etc/cloud/cloud.cfg.d/
2026-01-22 00:06:24.318 
2026-01-22 00:06:24.319 real	0m0.005s
2026-01-22 00:06:24.320 user	0m0.003s
2026-01-22 00:06:24.321 sys	0m0.000s
2026-01-22 00:06:24.322 ++ ls /media/
2026-01-22 00:06:24.323 + active_devices=()
2026-01-22 00:06:24.325 + for device in $block_devices
2026-01-22 00:06:24.326 + is_swap_device /dev/nvme0n1
2026-01-22 00:06:24.327 + local device=/dev/nvme0n1
2026-01-22 00:06:24.328 + local return_code=0
2026-01-22 00:06:24.329 + swapon -s
2026-01-22 00:06:24.330 + grep -w /dev/nvme0n1
2026-01-22 00:06:24.331 + return_code=1
2026-01-22 00:06:24.332 + return 1
2026-01-22 00:06:24.333 ++ is_active_device /dev/nvme0n1
2026-01-22 00:06:24.334 ++ local device=/dev/nvme0n1
2026-01-22 00:06:24.335 ++ matches_active_device_pattern /dev/nvme0n1
2026-01-22 00:06:24.336 ++ local device=/dev/nvme0n1
2026-01-22 00:06:24.337 ++ echo /dev/nvme0n1
2026-01-22 00:06:24.338 ++ grep -qE '/dev/xvda2|/dev/nvme[0-9]+n1|/dev/xvd[b-z]+'
2026-01-22 00:06:24.339 ++ od -N 0 /dev/nvme0n1
2026-01-22 00:06:24.341 ++ '[' 0 == 0 ']'
2026-01-22 00:06:24.342 ++ echo true
2026-01-22 00:06:24.343 + '[' true '!=' true ']'
2026-01-22 00:06:24.344 ++ is_link_from_root_device /dev/xvda /dev/nvme0n1
2026-01-22 00:06:24.345 +++ readlink -f /dev/xvda
2026-01-22 00:06:24.346 ++ local root_device=/dev/nvme0n1
2026-01-22 00:06:24.347 ++ local this_device=/dev/nvme0n1
2026-01-22 00:06:24.348 ++ [[ /dev/nvme0n1 == \/\d\e\v\/\n\v\m\e\0\n\1 ]]
2026-01-22 00:06:24.349 ++ echo true
2026-01-22 00:06:24.350 + '[' true == true ']'
2026-01-22 00:06:24.351 + continue
2026-01-22 00:06:24.352 + for device in $block_devices
2026-01-22 00:06:24.353 + is_swap_device /dev/nvme1n1
2026-01-22 00:06:24.354 + local device=/dev/nvme1n1
2026-01-22 00:06:24.355 + local return_code=0
2026-01-22 00:06:24.356 + swapon -s
2026-01-22 00:06:24.357 + grep -w /dev/nvme1n1
2026-01-22 00:06:24.358 + return_code=1
2026-01-22 00:06:24.359 + return 1
2026-01-22 00:06:24.360 ++ is_active_device /dev/nvme1n1
2026-01-22 00:06:24.361 ++ local device=/dev/nvme1n1
2026-01-22 00:06:24.362 ++ matches_active_device_pattern /dev/nvme1n1
2026-01-22 00:06:24.363 ++ local device=/dev/nvme1n1
2026-01-22 00:06:24.364 ++ echo /dev/nvme1n1
2026-01-22 00:06:24.365 ++ grep -qE '/dev/xvda2|/dev/nvme[0-9]+n1|/dev/xvd[b-z]+'
2026-01-22 00:06:24.366 ++ od -N 0 /dev/nvme1n1
2026-01-22 00:06:24.367 ++ '[' 0 == 0 ']'
2026-01-22 00:06:24.369 ++ echo true
2026-01-22 00:06:24.370 + '[' true '!=' true ']'
2026-01-22 00:06:24.371 ++ is_link_from_root_device /dev/xvda /dev/nvme1n1
2026-01-22 00:06:24.372 +++ readlink -f /dev/xvda
2026-01-22 00:06:24.373 ++ local root_device=/dev/nvme0n1
2026-01-22 00:06:24.374 ++ local this_device=/dev/nvme1n1
2026-01-22 00:06:24.375 ++ [[ /dev/nvme0n1 == \/\d\e\v\/\n\v\m\e\1\n\1 ]]
2026-01-22 00:06:24.377 + '[' '' == true ']'
2026-01-22 00:06:24.378 + umount -f /dev/nvme1n1
2026-01-22 00:06:24.379 umount: /dev/nvme1n1: not mounted.
2026-01-22 00:06:24.380 + true
2026-01-22 00:06:24.381 + remove_fstab_entry /dev/nvme1n1
2026-01-22 00:06:24.382 + local deviceIdentifier=/dev/nvme1n1
2026-01-22 00:06:24.384 + grep -v /dev/nvme1n1 /etc/fstab
2026-01-22 00:06:24.385 + mv /tmp/fstab /etc/fstab
2026-01-22 00:06:24.386 + '[' 0 == 0 ']'
2026-01-22 00:06:24.387 + sgdisk -o -n 1:0:+5GB -N2 -p /dev/nvme1n1
2026-01-22 00:06:25.402 Creating new GPT entries in memory.
2026-01-22 00:06:25.403 Disk /dev/nvme1n1: 67108864 sectors, 32.0 GiB
2026-01-22 00:06:25.404 Model: Amazon Elastic Block Store              
2026-01-22 00:06:25.406 Sector size (logical/physical): 512/512 bytes
2026-01-22 00:06:25.407 Disk identifier (GUID): 23A6018D-85A2-46E9-A2C5-2929BF48DF4C
2026-01-22 00:06:25.408 Partition table holds up to 128 entries
2026-01-22 00:06:25.409 Main partition table begins at sector 2 and ends at sector 33
2026-01-22 00:06:25.411 First usable sector is 34, last usable sector is 67108830
2026-01-22 00:06:25.412 Partitions will be aligned on 2048-sector boundaries
2026-01-22 00:06:25.413 Total free space is 2014 sectors (1007.0 KiB)
2026-01-22 00:06:25.414 
2026-01-22 00:06:25.415 Number  Start (sector)    End (sector)  Size       Code  Name
2026-01-22 00:06:25.416    1            2048        10487807   5.0 GiB     8300  
2026-01-22 00:06:25.417    2        10487808        67108830   27.0 GiB    8300  
2026-01-22 00:06:25.418 The operation has completed successfully.
2026-01-22 00:06:25.420 + active_devices=($(ls -1 $device?*))
2026-01-22 00:06:25.421 ++ ls -1 /dev/nvme1n1p1 /dev/nvme1n1p2
2026-01-22 00:06:25.422 + (( idx = idx + 1 ))
2026-01-22 00:06:25.423 + for device in $block_devices
2026-01-22 00:06:25.424 + is_swap_device /dev/nvme2n1
2026-01-22 00:06:25.425 + local device=/dev/nvme2n1
2026-01-22 00:06:25.426 + local return_code=0
2026-01-22 00:06:25.427 + swapon -s
2026-01-22 00:06:25.428 + grep -w /dev/nvme2n1
2026-01-22 00:06:25.429 + return_code=1
2026-01-22 00:06:25.430 + return 1
2026-01-22 00:06:25.431 ++ is_active_device /dev/nvme2n1
2026-01-22 00:06:25.432 ++ local device=/dev/nvme2n1
2026-01-22 00:06:25.434 ++ matches_active_device_pattern /dev/nvme2n1
2026-01-22 00:06:25.435 ++ local device=/dev/nvme2n1
2026-01-22 00:06:25.436 ++ echo /dev/nvme2n1
2026-01-22 00:06:25.437 ++ grep -qE '/dev/xvda2|/dev/nvme[0-9]+n1|/dev/xvd[b-z]+'
2026-01-22 00:06:25.438 ++ od -N 0 /dev/nvme2n1
2026-01-22 00:06:25.439 ++ '[' 0 == 0 ']'
2026-01-22 00:06:25.440 ++ echo true
2026-01-22 00:06:25.441 + '[' true '!=' true ']'
2026-01-22 00:06:25.442 ++ is_link_from_root_device /dev/xvda /dev/nvme2n1
2026-01-22 00:06:25.443 +++ readlink -f /dev/xvda
2026-01-22 00:06:25.444 ++ local root_device=/dev/nvme0n1
2026-01-22 00:06:25.445 ++ local this_device=/dev/nvme2n1
2026-01-22 00:06:25.446 ++ [[ /dev/nvme0n1 == \/\d\e\v\/\n\v\m\e\2\n\1 ]]
2026-01-22 00:06:25.447 + '[' '' == true ']'
2026-01-22 00:06:25.448 + umount -f /dev/nvme2n1
2026-01-22 00:06:25.449 umount: /dev/nvme2n1: not mounted.
2026-01-22 00:06:25.450 + true
2026-01-22 00:06:25.451 + remove_fstab_entry /dev/nvme2n1
2026-01-22 00:06:25.453 + local deviceIdentifier=/dev/nvme2n1
2026-01-22 00:06:25.454 + grep -v /dev/nvme2n1 /etc/fstab
2026-01-22 00:06:25.455 + mv /tmp/fstab /etc/fstab
2026-01-22 00:06:25.456 + '[' 1 == 0 ']'
2026-01-22 00:06:25.457 + active_devices+=($device)
2026-01-22 00:06:25.458 + (( idx = idx + 1 ))
2026-01-22 00:06:25.460 + encrypted_devices=($($INSTANCE_CONTROLLER_JAVA/java -cp $DISK_ENCRYPTOR_CP -Dlog4j2.configurationFile=file:$DISK_ENCRYPTOR_LOG4J2_CONFIG -Dlog4j2.formatMsgNoLookups=true -Dlog4j2.disable.jmx=true aws157.instancecontroller.encryptor.DiskEncryptorMain ${active_devices[*]}))
2026-01-22 00:06:25.461 ++ /usr/lib/jvm/jre-17/bin/java -cp '/usr/share/aws/emr/instance-controller/lib/*:/var/setup-devices/lib/*:/home/hadoop/conf:/usr/share/aws/aws-java-sdk-v2/*' -Dlog4j2.configurationFile=file:/etc/instance-controller/disk-encryptor-log4j2.xml -Dlog4j2.formatMsgNoLookups=true -Dlog4j2.disable.jmx=true aws157.instancecontroller.encryptor.DiskEncryptorMain /dev/nvme1n1p1 /dev/nvme1n1p2 /dev/nvme2n1
2026-01-22 00:06:31.511 SLF4J: Failed to load class "org.slf4j.impl.StaticLoggerBinder".
2026-01-22 00:06:31.513 SLF4J: Defaulting to no-operation (NOP) logger implementation
2026-01-22 00:06:31.514 SLF4J: See http://www.slf4j.org/codes.html#StaticLoggerBinder for further details.
2026-01-22 00:06:31.952 + make_xfs_parallel /dev/nvme1n1p1 /dev/nvme1n1p2 /dev/nvme2n1
2026-01-22 00:06:31.953 ++ printf '%s\n' /dev/nvme1n1p1 /dev/nvme1n1p2 /dev/nvme2n1
2026-01-22 00:06:31.954 + local 'devices=/dev/nvme1n1p1
2026-01-22 00:06:31.955 /dev/nvme1n1p2
2026-01-22 00:06:31.957 /dev/nvme2n1'
2026-01-22 00:06:31.959 ++ run_repeatedly 3 mktemp -t make_xfs_XXXXXXXXXX
2026-01-22 00:06:31.960 ++ (( i = 0 ))
2026-01-22 00:06:31.962 ++ (( i < 3 ))
2026-01-22 00:06:31.963 ++ mktemp -t make_xfs_XXXXXXXXXX
2026-01-22 00:06:31.964 ++ (( i++ ))
2026-01-22 00:06:31.965 ++ (( i < 3 ))
2026-01-22 00:06:31.966 ++ mktemp -t make_xfs_XXXXXXXXXX
2026-01-22 00:06:31.968 ++ (( i++ ))
2026-01-22 00:06:31.969 ++ (( i < 3 ))
2026-01-22 00:06:31.970 ++ mktemp -t make_xfs_XXXXXXXXXX
2026-01-22 00:06:31.971 ++ (( i++ ))
2026-01-22 00:06:31.972 ++ (( i < 3 ))
2026-01-22 00:06:31.973 + local 'log_files=/tmp/make_xfs_deAy6UJ57p
2026-01-22 00:06:31.974 /tmp/make_xfs_MUVdJAE4Hd
2026-01-22 00:06:31.975 /tmp/make_xfs_07UH4JfL23'
2026-01-22 00:06:31.976 + local return_code=0
2026-01-22 00:06:31.977 + run_make_xfs_parallel '/dev/nvme1n1p1
2026-01-22 00:06:31.979 /dev/nvme1n1p2
2026-01-22 00:06:31.980 /dev/nvme2n1' '/tmp/make_xfs_deAy6UJ57p
2026-01-22 00:06:31.981 /tmp/make_xfs_MUVdJAE4Hd
2026-01-22 00:06:31.982 /tmp/make_xfs_07UH4JfL23'
2026-01-22 00:06:31.983 + local 'devices=/dev/nvme1n1p1
2026-01-22 00:06:31.984 /dev/nvme1n1p2
2026-01-22 00:06:31.985 /dev/nvme2n1'
2026-01-22 00:06:31.986 + local 'log_files=/tmp/make_xfs_deAy6UJ57p
2026-01-22 00:06:31.988 /tmp/make_xfs_MUVdJAE4Hd
2026-01-22 00:06:31.989 /tmp/make_xfs_07UH4JfL23'
2026-01-22 00:06:31.990 + timeout --kill-after=10 10 bash -c '{ date; udevadm monitor; }'
2026-01-22 00:06:31.991 + interleave_lines '/dev/nvme1n1p1
2026-01-22 00:06:31.992 /dev/nvme1n1p2
2026-01-22 00:06:31.993 /dev/nvme2n1' '/tmp/make_xfs_deAy6UJ57p
2026-01-22 00:06:31.994 /tmp/make_xfs_MUVdJAE4Hd
2026-01-22 00:06:31.995 /tmp/make_xfs_07UH4JfL23'
2026-01-22 00:06:31.996 ++ date +%Y-%m-%d-%H-%M-%S
2026-01-22 00:06:31.997 + xargs -r --verbose -P0 -L2 bash -xc '
2026-01-22 00:06:31.998       device=$0; log_file=$1
2026-01-22 00:06:31.999       { time mkfs.xfs -f "$device"; exit $?; } > "$log_file" 2>&1'
2026-01-22 00:06:32.000 + paste '-d\n' /dev/fd/63 /dev/fd/62
2026-01-22 00:06:32.001 ++ echo '/dev/nvme1n1p1
2026-01-22 00:06:32.003 /dev/nvme1n1p2
2026-01-22 00:06:32.004 /dev/nvme2n1'
2026-01-22 00:06:32.005 ++ echo '/tmp/make_xfs_deAy6UJ57p
2026-01-22 00:06:32.006 /tmp/make_xfs_MUVdJAE4Hd
2026-01-22 00:06:32.007 /tmp/make_xfs_07UH4JfL23'
2026-01-22 00:06:32.008 bash -xc ''$'\n''      device=$0; log_file=$1'$'\n''      { time mkfs.xfs -f "$device"; exit $?; } > "$log_file" 2>&1' /dev/nvme1n1p1 /tmp/make_xfs_deAy6UJ57p
2026-01-22 00:06:32.009 bash -xc ''$'\n''      device=$0; log_file=$1'$'\n''      { time mkfs.xfs -f "$device"; exit $?; } > "$log_file" 2>&1' /dev/nvme1n1p2 /tmp/make_xfs_MUVdJAE4Hd
2026-01-22 00:06:32.010 bash -xc ''$'\n''      device=$0; log_file=$1'$'\n''      { time mkfs.xfs -f "$device"; exit $?; } > "$log_file" 2>&1' /dev/nvme2n1 /tmp/make_xfs_07UH4JfL23
2026-01-22 00:06:32.011 + device=/dev/nvme1n1p1
2026-01-22 00:06:32.012 + log_file=/tmp/make_xfs_deAy6UJ57p
2026-01-22 00:06:32.013 + device=/dev/nvme1n1p2
2026-01-22 00:06:32.014 + log_file=/tmp/make_xfs_MUVdJAE4Hd
2026-01-22 00:06:32.015 + device=/dev/nvme2n1
2026-01-22 00:06:32.016 + log_file=/tmp/make_xfs_07UH4JfL23
2026-01-22 00:06:32.359 + echo 'Waiting for udev to settle'
2026-01-22 00:06:32.361 Waiting for udev to settle
2026-01-22 00:06:32.362 + udevadm settle
2026-01-22 00:06:32.457 + echo 'udevadmn settle finished'
2026-01-22 00:06:32.458 udevadmn settle finished
2026-01-22 00:06:32.460 + process_log_files '/tmp/make_xfs_deAy6UJ57p
2026-01-22 00:06:32.461 /tmp/make_xfs_MUVdJAE4Hd
2026-01-22 00:06:32.462 /tmp/make_xfs_07UH4JfL23'
2026-01-22 00:06:32.463 + '[' -n '/tmp/make_xfs_deAy6UJ57p
2026-01-22 00:06:32.464 /tmp/make_xfs_MUVdJAE4Hd
2026-01-22 00:06:32.466 /tmp/make_xfs_07UH4JfL23' ']'
2026-01-22 00:06:32.467 + echo '/tmp/make_xfs_deAy6UJ57p
2026-01-22 00:06:32.468 /tmp/make_xfs_MUVdJAE4Hd
2026-01-22 00:06:32.469 /tmp/make_xfs_07UH4JfL23'
2026-01-22 00:06:32.470 + read -r log_file
2026-01-22 00:06:32.471 + sed 's#^#    #' /tmp/make_xfs_deAy6UJ57p
2026-01-22 00:06:32.472     + mkfs.xfs -f /dev/nvme1n1p1
2026-01-22 00:06:32.474     meta-data=/dev/nvme1n1p1         isize=512    agcount=8, agsize=163840 blks
2026-01-22 00:06:32.475              =                       sectsz=512   attr=2, projid32bit=1
2026-01-22 00:06:32.476              =                       crc=1        finobt=1, sparse=1, rmapbt=0
2026-01-22 00:06:32.478              =                       reflink=1    bigtime=1 inobtcount=1 nrext64=0
2026-01-22 00:06:32.479              =                       exchange=0  
2026-01-22 00:06:32.480     data     =                       bsize=4096   blocks=1310720, imaxpct=25
2026-01-22 00:06:32.481              =                       sunit=1      swidth=1 blks
2026-01-22 00:06:32.482     naming   =version 2              bsize=4096   ascii-ci=0, ftype=1, parent=0
2026-01-22 00:06:32.483     log      =internal log           bsize=4096   blocks=16384, version=2
2026-01-22 00:06:32.484              =                       sectsz=512   sunit=1 blks, lazy-count=1
2026-01-22 00:06:32.486     realtime =none                   extsz=4096   blocks=0, rtextents=0
2026-01-22 00:06:32.487     
2026-01-22 00:06:32.488     real	0m0.332s
2026-01-22 00:06:32.489     user	0m0.007s
2026-01-22 00:06:32.490     sys	0m0.000s
2026-01-22 00:06:32.491     + exit 0
2026-01-22 00:06:32.492 + rm /tmp/make_xfs_deAy6UJ57p
2026-01-22 00:06:32.493 + read -r log_file
2026-01-22 00:06:32.494 + sed 's#^#    #' /tmp/make_xfs_MUVdJAE4Hd
2026-01-22 00:06:32.495     + mkfs.xfs -f /dev/nvme1n1p2
2026-01-22 00:06:32.496     meta-data=/dev/nvme1n1p2         isize=512    agcount=16, agsize=442352 blks
2026-01-22 00:06:32.497              =                       sectsz=512   attr=2, projid32bit=1
2026-01-22 00:06:32.498              =                       crc=1        finobt=1, sparse=1, rmapbt=0
2026-01-22 00:06:32.499              =                       reflink=1    bigtime=1 inobtcount=1 nrext64=0
2026-01-22 00:06:32.501              =                       exchange=0  
2026-01-22 00:06:32.502     data     =                       bsize=4096   blocks=7077627, imaxpct=25
2026-01-22 00:06:32.503              =                       sunit=1      swidth=1 blks
2026-01-22 00:06:32.504     naming   =version 2              bsize=4096   ascii-ci=0, ftype=1, parent=0
2026-01-22 00:06:32.505     log      =internal log           bsize=4096   blocks=16384, version=2
2026-01-22 00:06:32.506              =                       sectsz=512   sunit=1 blks, lazy-count=1
2026-01-22 00:06:32.507     realtime =none                   extsz=4096   blocks=0, rtextents=0
2026-01-22 00:06:32.508     
2026-01-22 00:06:32.509     real	0m0.397s
2026-01-22 00:06:32.510     user	0m0.000s
2026-01-22 00:06:32.511     sys	0m0.008s
2026-01-22 00:06:32.512     + exit 0
2026-01-22 00:06:32.514 + rm /tmp/make_xfs_MUVdJAE4Hd
2026-01-22 00:06:32.515 + read -r log_file
2026-01-22 00:06:32.516 + sed 's#^#    #' /tmp/make_xfs_07UH4JfL23
2026-01-22 00:06:32.517     + mkfs.xfs -f /dev/nvme2n1
2026-01-22 00:06:32.518     meta-data=/dev/nvme2n1           isize=512    agcount=16, agsize=524288 blks
2026-01-22 00:06:32.519              =                       sectsz=512   attr=2, projid32bit=1
2026-01-22 00:06:32.520              =                       crc=1        finobt=1, sparse=1, rmapbt=0
2026-01-22 00:06:32.521              =                       reflink=1    bigtime=1 inobtcount=1 nrext64=0
2026-01-22 00:06:32.522              =                       exchange=0  
2026-01-22 00:06:32.523     data     =                       bsize=4096   blocks=8388608, imaxpct=25
2026-01-22 00:06:32.524              =                       sunit=1      swidth=1 blks
2026-01-22 00:06:32.525     naming   =version 2              bsize=4096   ascii-ci=0, ftype=1, parent=0
2026-01-22 00:06:32.527     log      =internal log           bsize=4096   blocks=16384, version=2
2026-01-22 00:06:32.528              =                       sectsz=512   sunit=1 blks, lazy-count=1
2026-01-22 00:06:32.530     realtime =none                   extsz=4096   blocks=0, rtextents=0
2026-01-22 00:06:32.531     
2026-01-22 00:06:32.532     real	0m0.381s
2026-01-22 00:06:32.533     user	0m0.008s
2026-01-22 00:06:32.534     sys	0m0.000s
2026-01-22 00:06:32.535     + exit 0
2026-01-22 00:06:32.536 + rm /tmp/make_xfs_07UH4JfL23
2026-01-22 00:06:32.537 + read -r log_file
2026-01-22 00:06:32.538 + return 0
2026-01-22 00:06:32.539 + emrDevice=/dev/nvme1n1p1
2026-01-22 00:06:32.540 + encrypted_devices=("${encrypted_devices[@]:1}")
2026-01-22 00:06:32.541 + create_devices_mount_map /dev/nvme1n1p1 /emr
2026-01-22 00:06:32.543 + local deviceFile=/dev/nvme1n1p1
2026-01-22 00:06:32.544 + local mount_point=/emr
2026-01-22 00:06:32.545 + echo /dev/nvme1n1p1
2026-01-22 00:06:32.546 + grep -qs /mapper
2026-01-22 00:06:32.547 ++ repeat_command_until_not_empty 'lsblk -o UUID -ipnd /dev/nvme1n1p1' 5
2026-01-22 00:06:32.549 ++ local 'cmd=lsblk -o UUID -ipnd /dev/nvme1n1p1'
2026-01-22 00:06:32.550 ++ local maxWait=5
2026-01-22 00:06:32.551 ++ local result=
2026-01-22 00:06:32.552 +++ date +%s
2026-01-22 00:06:32.553 ++ endTime=1769040397
2026-01-22 00:06:32.554 ++ '[' -z ']'
2026-01-22 00:06:32.555 +++ date +%s
2026-01-22 00:06:32.557 ++ '[' 1769040392 -lt 1769040397 ']'
2026-01-22 00:06:32.558 +++ bash -c 'lsblk -o UUID -ipnd /dev/nvme1n1p1'
2026-01-22 00:06:32.559 ++ result=ce693955-adfc-495c-a17d-b8b8e447ba24
2026-01-22 00:06:32.560 ++ '[' -z ce693955-adfc-495c-a17d-b8b8e447ba24 ']'
2026-01-22 00:06:32.561 ++ printf ce693955-adfc-495c-a17d-b8b8e447ba24
2026-01-22 00:06:32.562 + local deviceUUID=ce693955-adfc-495c-a17d-b8b8e447ba24
2026-01-22 00:06:32.563 + '[' -z ce693955-adfc-495c-a17d-b8b8e447ba24 ']'
2026-01-22 00:06:32.564 + create_drive ce693955-adfc-495c-a17d-b8b8e447ba24 /emr
2026-01-22 00:06:32.565 + local deviceUUID=ce693955-adfc-495c-a17d-b8b8e447ba24
2026-01-22 00:06:32.567 + local drive=/emr
2026-01-22 00:06:32.568 + create_directory /emr
2026-01-22 00:06:32.569 + local dir=/emr
2026-01-22 00:06:32.570 + '[' -d /emr ']'
2026-01-22 00:06:32.571 + '[' -d /emr ']'
2026-01-22 00:06:32.572 + mount_drive ce693955-adfc-495c-a17d-b8b8e447ba24 /emr
2026-01-22 00:06:32.573 + local deviceUUID=ce693955-adfc-495c-a17d-b8b8e447ba24
2026-01-22 00:06:32.574 + local mountPoint=/emr
2026-01-22 00:06:32.575 + lsblk -o UUID,MOUNTPOINT -ipnr
2026-01-22 00:06:32.576 + grep -
2026-01-22 00:06:32.577 + grep -qs '^ce693955-adfc-495c-a17d-b8b8e447ba24 /emr$'
2026-01-22 00:06:32.578 + [[ /emr == \/\e\m\r ]]
2026-01-22 00:06:32.579 + mount -o inode64,nodev -t xfs UUID=ce693955-adfc-495c-a17d-b8b8e447ba24 /emr
2026-01-22 00:06:32.580 + remove_fstab_entry ce693955-adfc-495c-a17d-b8b8e447ba24
2026-01-22 00:06:32.581 + local deviceIdentifier=ce693955-adfc-495c-a17d-b8b8e447ba24
2026-01-22 00:06:32.583 + grep -v ce693955-adfc-495c-a17d-b8b8e447ba24 /etc/fstab
2026-01-22 00:06:32.584 + mv /tmp/fstab /etc/fstab
2026-01-22 00:06:32.585 + echo 'UUID=ce693955-adfc-495c-a17d-b8b8e447ba24 /emr xfs defaults,noauto,comment=emr-setup-devices 0 0'
2026-01-22 00:06:32.586 + echo 'ce693955-adfc-495c-a17d-b8b8e447ba24 /emr'
2026-01-22 00:06:32.587 + mntDevice=/dev/nvme1n1p2
2026-01-22 00:06:32.588 + encrypted_devices=("${encrypted_devices[@]:1}")
2026-01-22 00:06:32.589 + create_devices_mount_map /dev/nvme1n1p2 /mnt
2026-01-22 00:06:32.590 + local deviceFile=/dev/nvme1n1p2
2026-01-22 00:06:32.591 + local mount_point=/mnt
2026-01-22 00:06:32.592 + echo /dev/nvme1n1p2
2026-01-22 00:06:32.593 + grep -qs /mapper
2026-01-22 00:06:32.594 ++ repeat_command_until_not_empty 'lsblk -o UUID -ipnd /dev/nvme1n1p2' 5
2026-01-22 00:06:32.595 ++ local 'cmd=lsblk -o UUID -ipnd /dev/nvme1n1p2'
2026-01-22 00:06:32.596 ++ local maxWait=5
2026-01-22 00:06:32.597 ++ local result=
2026-01-22 00:06:32.599 +++ date +%s
2026-01-22 00:06:32.600 ++ endTime=1769040397
2026-01-22 00:06:32.601 ++ '[' -z ']'
2026-01-22 00:06:32.602 +++ date +%s
2026-01-22 00:06:32.603 ++ '[' 1769040392 -lt 1769040397 ']'
2026-01-22 00:06:32.604 +++ bash -c 'lsblk -o UUID -ipnd /dev/nvme1n1p2'
2026-01-22 00:06:32.605 ++ result=89030c5c-e05f-40fe-b86f-8b64cedd14ff
2026-01-22 00:06:32.606 ++ '[' -z 89030c5c-e05f-40fe-b86f-8b64cedd14ff ']'
2026-01-22 00:06:32.608 ++ printf 89030c5c-e05f-40fe-b86f-8b64cedd14ff
2026-01-22 00:06:32.609 + local deviceUUID=89030c5c-e05f-40fe-b86f-8b64cedd14ff
2026-01-22 00:06:32.610 + '[' -z 89030c5c-e05f-40fe-b86f-8b64cedd14ff ']'
2026-01-22 00:06:32.611 + create_drive 89030c5c-e05f-40fe-b86f-8b64cedd14ff /mnt
2026-01-22 00:06:32.612 + local deviceUUID=89030c5c-e05f-40fe-b86f-8b64cedd14ff
2026-01-22 00:06:32.613 + local drive=/mnt
2026-01-22 00:06:32.614 + create_directory /mnt
2026-01-22 00:06:32.615 + local dir=/mnt
2026-01-22 00:06:32.616 + '[' -d /mnt ']'
2026-01-22 00:06:32.618 + '[' -d /mnt ']'
2026-01-22 00:06:32.619 + mount_drive 89030c5c-e05f-40fe-b86f-8b64cedd14ff /mnt
2026-01-22 00:06:32.620 + local deviceUUID=89030c5c-e05f-40fe-b86f-8b64cedd14ff
2026-01-22 00:06:32.621 + local mountPoint=/mnt
2026-01-22 00:06:32.623 + lsblk -o UUID,MOUNTPOINT -ipnr
2026-01-22 00:06:32.624 + grep -
2026-01-22 00:06:32.625 + grep -qs '^89030c5c-e05f-40fe-b86f-8b64cedd14ff /mnt$'
2026-01-22 00:06:32.626 + [[ /mnt == \/\e\m\r ]]
2026-01-22 00:06:32.627 + mount -o inode64,nodev,usrquota,grpquota,prjquota -t xfs UUID=89030c5c-e05f-40fe-b86f-8b64cedd14ff /mnt
2026-01-22 00:06:32.629 + remove_fstab_entry 89030c5c-e05f-40fe-b86f-8b64cedd14ff
2026-01-22 00:06:32.630 + local deviceIdentifier=89030c5c-e05f-40fe-b86f-8b64cedd14ff
2026-01-22 00:06:32.631 + grep -v 89030c5c-e05f-40fe-b86f-8b64cedd14ff /etc/fstab
2026-01-22 00:06:32.632 + mv /tmp/fstab /etc/fstab
2026-01-22 00:06:32.634 + echo 'UUID=89030c5c-e05f-40fe-b86f-8b64cedd14ff /mnt xfs defaults,noauto,comment=emr-setup-devices 0 0'
2026-01-22 00:06:32.635 + echo '89030c5c-e05f-40fe-b86f-8b64cedd14ff /mnt'
2026-01-22 00:06:32.636 + deviceIdx=1
2026-01-22 00:06:32.637 + for dev in "${encrypted_devices[@]}"
2026-01-22 00:06:32.638 + create_devices_mount_map /dev/nvme2n1 /mnt1
2026-01-22 00:06:32.639 + local deviceFile=/dev/nvme2n1
2026-01-22 00:06:32.640 + local mount_point=/mnt1
2026-01-22 00:06:32.641 + echo /dev/nvme2n1
2026-01-22 00:06:32.643 + grep -qs /mapper
2026-01-22 00:06:32.644 ++ repeat_command_until_not_empty 'lsblk -o UUID -ipnd /dev/nvme2n1' 5
2026-01-22 00:06:32.645 ++ local 'cmd=lsblk -o UUID -ipnd /dev/nvme2n1'
2026-01-22 00:06:32.646 ++ local maxWait=5
2026-01-22 00:06:32.647 ++ local result=
2026-01-22 00:06:32.648 +++ date +%s
2026-01-22 00:06:32.649 ++ endTime=1769040397
2026-01-22 00:06:32.650 ++ '[' -z ']'
2026-01-22 00:06:32.651 +++ date +%s
2026-01-22 00:06:32.652 ++ '[' 1769040392 -lt 1769040397 ']'
2026-01-22 00:06:32.653 +++ bash -c 'lsblk -o UUID -ipnd /dev/nvme2n1'
2026-01-22 00:06:32.654 ++ result=bb4277f2-ee27-40a2-b485-8747dbbf4ae0
2026-01-22 00:06:32.655 ++ '[' -z bb4277f2-ee27-40a2-b485-8747dbbf4ae0 ']'
2026-01-22 00:06:32.657 ++ printf bb4277f2-ee27-40a2-b485-8747dbbf4ae0
2026-01-22 00:06:32.658 + local deviceUUID=bb4277f2-ee27-40a2-b485-8747dbbf4ae0
2026-01-22 00:06:32.659 + '[' -z bb4277f2-ee27-40a2-b485-8747dbbf4ae0 ']'
2026-01-22 00:06:32.660 + create_drive bb4277f2-ee27-40a2-b485-8747dbbf4ae0 /mnt1
2026-01-22 00:06:32.661 + local deviceUUID=bb4277f2-ee27-40a2-b485-8747dbbf4ae0
2026-01-22 00:06:32.662 + local drive=/mnt1
2026-01-22 00:06:32.663 + create_directory /mnt1
2026-01-22 00:06:32.664 + local dir=/mnt1
2026-01-22 00:06:32.665 + '[' -d /mnt1 ']'
2026-01-22 00:06:32.667 + mkdir -p /mnt1
2026-01-22 00:06:32.668 + '[' -d /mnt1 ']'
2026-01-22 00:06:32.669 + mount_drive bb4277f2-ee27-40a2-b485-8747dbbf4ae0 /mnt1
2026-01-22 00:06:32.670 + local deviceUUID=bb4277f2-ee27-40a2-b485-8747dbbf4ae0
2026-01-22 00:06:32.671 + local mountPoint=/mnt1
2026-01-22 00:06:32.672 + lsblk -o UUID,MOUNTPOINT -ipnr
2026-01-22 00:06:32.673 + grep -
2026-01-22 00:06:32.674 + grep -qs '^bb4277f2-ee27-40a2-b485-8747dbbf4ae0 /mnt1$'
2026-01-22 00:06:32.675 + [[ /mnt1 == \/\e\m\r ]]
2026-01-22 00:06:32.676 + mount -o inode64,nodev,usrquota,grpquota,prjquota -t xfs UUID=bb4277f2-ee27-40a2-b485-8747dbbf4ae0 /mnt1
2026-01-22 00:06:32.707 + remove_fstab_entry bb4277f2-ee27-40a2-b485-8747dbbf4ae0
2026-01-22 00:06:32.708 + local deviceIdentifier=bb4277f2-ee27-40a2-b485-8747dbbf4ae0
2026-01-22 00:06:32.710 + grep -v bb4277f2-ee27-40a2-b485-8747dbbf4ae0 /etc/fstab
2026-01-22 00:06:32.712 + mv /tmp/fstab /etc/fstab
2026-01-22 00:06:32.713 + echo 'UUID=bb4277f2-ee27-40a2-b485-8747dbbf4ae0 /mnt1 xfs defaults,noauto,comment=emr-setup-devices 0 0'
2026-01-22 00:06:32.715 + echo 'bb4277f2-ee27-40a2-b485-8747dbbf4ae0 /mnt1'
2026-01-22 00:06:32.716 + (( deviceIdx = deviceIdx + 1 ))
2026-01-22 00:06:32.717 + tee -a /dev/console
2026-01-22 00:06:32.723 ++ date
2026-01-22 00:06:32.724 + echo 'Drives setup completed at: Thu' Jan 22 00:06:32 UTC 2026
2026-01-22 00:06:32.725 Drives setup completed at: Thu Jan 22 00:06:32 UTC 2026
2026-01-22 00:06:32.726 + echo 'Currently mounted devices: '
2026-01-22 00:06:32.727 + tee -a /dev/console
2026-01-22 00:06:32.728 Currently mounted devices: 
2026-01-22 00:06:32.729 + df
2026-01-22 00:06:32.731 + tee -a /dev/console
2026-01-22 00:06:32.732 Filesystem       1K-blocks    Used Available Use% Mounted on
2026-01-22 00:06:32.733 devtmpfs              4096       0      4096   0% /dev
2026-01-22 00:06:32.734 tmpfs              8078908       0   8078908   0% /dev/shm
2026-01-22 00:06:32.735 tmpfs              3231564    8604   3222960   1% /run
2026-01-22 00:06:32.736 /dev/nvme0n1p1    15650796 7156072   8494724  46% /
2026-01-22 00:06:32.737 /dev/nvme0n1p128     10202    1314      8888  13% /boot/efi
2026-01-22 00:06:32.738 /dev/nvme1n1p1     5177344   69368   5107976   2% /emr
2026-01-22 00:06:32.739 /dev/nvme1n1p2    28244972  230756  28014216   1% /mnt
2026-01-22 00:06:32.740 /dev/nvme2n1      33488896  267356  33221540   1% /mnt1
2026-01-22 00:06:32.741 
2026-01-22 00:06:32.742 real	0m8.513s
2026-01-22 00:06:32.743 user	0m2.685s
2026-01-22 00:06:32.744 sys	0m0.215s
