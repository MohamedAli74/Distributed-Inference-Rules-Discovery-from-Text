2026-01-22 00:38:19.397 + setup_drives
2026-01-22 00:38:19.400 + local idx=0
2026-01-22 00:38:19.401 + tee -a /dev/console
2026-01-22 00:38:19.403 ++ date
2026-01-22 00:38:19.405 + echo 'Drives setup started at: Thu' Jan 22 00:38:19 UTC 2026
2026-01-22 00:38:19.406 Drives setup started at: Thu Jan 22 00:38:19 UTC 2026
2026-01-22 00:38:19.407 + set -xe
2026-01-22 00:38:19.408 ++ find /usr/share/aws/emr/instance-controller/lib -name 'instance-controller*.jar' -and -not -name '*interface*'
2026-01-22 00:38:19.418 + local instance_controller_jar=/usr/share/aws/emr/instance-controller/lib/instance-controller-1.85.0.jar
2026-01-22 00:38:19.420 + '[' -e /var/setup-devices/device-names.json ']'
2026-01-22 00:38:19.421 ++ lsblk -pdno NAME
2026-01-22 00:38:19.423 ++ sort -V
2026-01-22 00:38:19.431 + local 'block_devices=/dev/nvme0n1
2026-01-22 00:38:19.433 /dev/nvme1n1
2026-01-22 00:38:19.434 /dev/nvme2n1'
2026-01-22 00:38:19.435 ++ cat /var/setup-devices/device-names.json
2026-01-22 00:38:19.436 ++ jq -r '.symlinkDevices | keys[]'
2026-01-22 00:38:19.437 ++ tr '\n' ' '
2026-01-22 00:38:19.445 + symlink_devices=('/dev/nvme0n1' '/dev/nvme2n1')
2026-01-22 00:38:19.446 + local symlink_devices
2026-01-22 00:38:19.447 ++ jq -r '.deviceNameRegex[]'
2026-01-22 00:38:19.449 ++ paste -s -d '|'
2026-01-22 00:38:19.456 + active_device_pattern='/dev/xvda2|/dev/nvme[0-9]+n1|/dev/xvd[b-z]+'
2026-01-22 00:38:19.457 + for symlink_device in ${symlink_devices[*]}
2026-01-22 00:38:19.458 ++ cat /var/setup-devices/device-names.json
2026-01-22 00:38:19.459 ++ jq -r '.symlinkDevices."/dev/nvme0n1"'
2026-01-22 00:38:19.461 + link_to_device=('/dev/xvda')
2026-01-22 00:38:19.462 + local link_to_device
2026-01-22 00:38:19.463 + symlink_root_device /dev/xvda /dev/nvme0n1
2026-01-22 00:38:19.465 + local root_device=/dev/xvda
2026-01-22 00:38:19.466 + local other_device=/dev/nvme0n1
2026-01-22 00:38:19.467 + '[' '!' -e /dev/xvda ']'
2026-01-22 00:38:19.468 + for symlink_device in ${symlink_devices[*]}
2026-01-22 00:38:19.470 ++ cat /var/setup-devices/device-names.json
2026-01-22 00:38:19.471 ++ jq -r '.symlinkDevices."/dev/nvme0n1"'
2026-01-22 00:38:19.472 + link_to_device=('/dev/xvda')
2026-01-22 00:38:19.473 + local link_to_device
2026-01-22 00:38:19.474 + symlink_root_device /dev/xvda /dev/nvme2n1
2026-01-22 00:38:19.475 + local root_device=/dev/xvda
2026-01-22 00:38:19.477 + local other_device=/dev/nvme2n1
2026-01-22 00:38:19.478 + '[' '!' -e /dev/xvda ']'
2026-01-22 00:38:19.479 + [[ ! -e /var/setup-devices/completed ]]
2026-01-22 00:38:19.480 + setup_cloud_cfg
2026-01-22 00:38:19.482 + cat
2026-01-22 00:38:19.483 + mv /tmp/00_emr.cfg /etc/cloud/cloud.cfg.d/
2026-01-22 00:38:19.484 
2026-01-22 00:38:19.485 real	0m0.006s
2026-01-22 00:38:19.486 user	0m0.002s
2026-01-22 00:38:19.487 sys	0m0.001s
2026-01-22 00:38:19.489 ++ ls /media/
2026-01-22 00:38:19.490 + active_devices=()
2026-01-22 00:38:19.491 + for device in $block_devices
2026-01-22 00:38:19.492 + is_swap_device /dev/nvme0n1
2026-01-22 00:38:19.493 + local device=/dev/nvme0n1
2026-01-22 00:38:19.494 + local return_code=0
2026-01-22 00:38:19.495 + swapon -s
2026-01-22 00:38:19.496 + grep -w /dev/nvme0n1
2026-01-22 00:38:19.497 + return_code=1
2026-01-22 00:38:19.498 + return 1
2026-01-22 00:38:19.500 ++ is_active_device /dev/nvme0n1
2026-01-22 00:38:19.501 ++ local device=/dev/nvme0n1
2026-01-22 00:38:19.502 ++ matches_active_device_pattern /dev/nvme0n1
2026-01-22 00:38:19.503 ++ local device=/dev/nvme0n1
2026-01-22 00:38:19.504 ++ echo /dev/nvme0n1
2026-01-22 00:38:19.505 ++ grep -qE '/dev/xvda2|/dev/nvme[0-9]+n1|/dev/xvd[b-z]+'
2026-01-22 00:38:19.506 ++ od -N 0 /dev/nvme0n1
2026-01-22 00:38:19.507 ++ '[' 0 == 0 ']'
2026-01-22 00:38:19.508 ++ echo true
2026-01-22 00:38:19.509 + '[' true '!=' true ']'
2026-01-22 00:38:19.510 ++ is_link_from_root_device /dev/xvda /dev/nvme0n1
2026-01-22 00:38:19.511 +++ readlink -f /dev/xvda
2026-01-22 00:38:19.512 ++ local root_device=/dev/nvme0n1
2026-01-22 00:38:19.513 ++ local this_device=/dev/nvme0n1
2026-01-22 00:38:19.514 ++ [[ /dev/nvme0n1 == \/\d\e\v\/\n\v\m\e\0\n\1 ]]
2026-01-22 00:38:19.515 ++ echo true
2026-01-22 00:38:19.516 + '[' true == true ']'
2026-01-22 00:38:19.517 + continue
2026-01-22 00:38:19.518 + for device in $block_devices
2026-01-22 00:38:19.519 + is_swap_device /dev/nvme1n1
2026-01-22 00:38:19.521 + local device=/dev/nvme1n1
2026-01-22 00:38:19.522 + local return_code=0
2026-01-22 00:38:19.523 + swapon -s
2026-01-22 00:38:19.524 + grep -w /dev/nvme1n1
2026-01-22 00:38:19.525 + return_code=1
2026-01-22 00:38:19.526 + return 1
2026-01-22 00:38:19.527 ++ is_active_device /dev/nvme1n1
2026-01-22 00:38:19.528 ++ local device=/dev/nvme1n1
2026-01-22 00:38:19.529 ++ matches_active_device_pattern /dev/nvme1n1
2026-01-22 00:38:19.531 ++ local device=/dev/nvme1n1
2026-01-22 00:38:19.532 ++ echo /dev/nvme1n1
2026-01-22 00:38:19.533 ++ grep -qE '/dev/xvda2|/dev/nvme[0-9]+n1|/dev/xvd[b-z]+'
2026-01-22 00:38:19.535 ++ od -N 0 /dev/nvme1n1
2026-01-22 00:38:19.538 ++ '[' 0 == 0 ']'
2026-01-22 00:38:19.540 ++ echo true
2026-01-22 00:38:19.541 + '[' true '!=' true ']'
2026-01-22 00:38:19.542 ++ is_link_from_root_device /dev/xvda /dev/nvme1n1
2026-01-22 00:38:19.543 +++ readlink -f /dev/xvda
2026-01-22 00:38:19.544 ++ local root_device=/dev/nvme0n1
2026-01-22 00:38:19.545 ++ local this_device=/dev/nvme1n1
2026-01-22 00:38:19.546 ++ [[ /dev/nvme0n1 == \/\d\e\v\/\n\v\m\e\1\n\1 ]]
2026-01-22 00:38:19.547 + '[' '' == true ']'
2026-01-22 00:38:19.549 + umount -f /dev/nvme1n1
2026-01-22 00:38:19.550 umount: /dev/nvme1n1: not mounted.
2026-01-22 00:38:19.551 + true
2026-01-22 00:38:19.552 + remove_fstab_entry /dev/nvme1n1
2026-01-22 00:38:19.553 + local deviceIdentifier=/dev/nvme1n1
2026-01-22 00:38:19.554 + grep -v /dev/nvme1n1 /etc/fstab
2026-01-22 00:38:19.556 + mv /tmp/fstab /etc/fstab
2026-01-22 00:38:19.557 + '[' 0 == 0 ']'
2026-01-22 00:38:19.558 + sgdisk -o -n 1:0:+5GB -N2 -p /dev/nvme1n1
2026-01-22 00:38:20.553 Creating new GPT entries in memory.
2026-01-22 00:38:20.554 Disk /dev/nvme1n1: 67108864 sectors, 32.0 GiB
2026-01-22 00:38:20.556 Model: Amazon Elastic Block Store              
2026-01-22 00:38:20.557 Sector size (logical/physical): 512/512 bytes
2026-01-22 00:38:20.558 Disk identifier (GUID): 848D258D-B774-4240-B852-1E8BCC915C02
2026-01-22 00:38:20.560 Partition table holds up to 128 entries
2026-01-22 00:38:20.561 Main partition table begins at sector 2 and ends at sector 33
2026-01-22 00:38:20.562 First usable sector is 34, last usable sector is 67108830
2026-01-22 00:38:20.563 Partitions will be aligned on 2048-sector boundaries
2026-01-22 00:38:20.565 Total free space is 2014 sectors (1007.0 KiB)
2026-01-22 00:38:20.566 
2026-01-22 00:38:20.567 Number  Start (sector)    End (sector)  Size       Code  Name
2026-01-22 00:38:20.568    1            2048        10487807   5.0 GiB     8300  
2026-01-22 00:38:20.569    2        10487808        67108830   27.0 GiB    8300  
2026-01-22 00:38:20.570 The operation has completed successfully.
2026-01-22 00:38:20.571 + active_devices=($(ls -1 $device?*))
2026-01-22 00:38:20.572 ++ ls -1 /dev/nvme1n1p1 /dev/nvme1n1p2
2026-01-22 00:38:20.573 + (( idx = idx + 1 ))
2026-01-22 00:38:20.574 + for device in $block_devices
2026-01-22 00:38:20.576 + is_swap_device /dev/nvme2n1
2026-01-22 00:38:20.577 + local device=/dev/nvme2n1
2026-01-22 00:38:20.578 + local return_code=0
2026-01-22 00:38:20.579 + swapon -s
2026-01-22 00:38:20.580 + grep -w /dev/nvme2n1
2026-01-22 00:38:20.581 + return_code=1
2026-01-22 00:38:20.582 + return 1
2026-01-22 00:38:20.583 ++ is_active_device /dev/nvme2n1
2026-01-22 00:38:20.584 ++ local device=/dev/nvme2n1
2026-01-22 00:38:20.585 ++ matches_active_device_pattern /dev/nvme2n1
2026-01-22 00:38:20.586 ++ local device=/dev/nvme2n1
2026-01-22 00:38:20.587 ++ echo /dev/nvme2n1
2026-01-22 00:38:20.588 ++ grep -qE '/dev/xvda2|/dev/nvme[0-9]+n1|/dev/xvd[b-z]+'
2026-01-22 00:38:20.589 ++ od -N 0 /dev/nvme2n1
2026-01-22 00:38:20.590 ++ '[' 0 == 0 ']'
2026-01-22 00:38:20.591 ++ echo true
2026-01-22 00:38:20.592 + '[' true '!=' true ']'
2026-01-22 00:38:20.593 ++ is_link_from_root_device /dev/xvda /dev/nvme2n1
2026-01-22 00:38:20.594 +++ readlink -f /dev/xvda
2026-01-22 00:38:20.596 ++ local root_device=/dev/nvme0n1
2026-01-22 00:38:20.597 ++ local this_device=/dev/nvme2n1
2026-01-22 00:38:20.598 ++ [[ /dev/nvme0n1 == \/\d\e\v\/\n\v\m\e\2\n\1 ]]
2026-01-22 00:38:20.599 + '[' '' == true ']'
2026-01-22 00:38:20.600 + umount -f /dev/nvme2n1
2026-01-22 00:38:20.601 umount: /dev/nvme2n1: not mounted.
2026-01-22 00:38:20.602 + true
2026-01-22 00:38:20.603 + remove_fstab_entry /dev/nvme2n1
2026-01-22 00:38:20.604 + local deviceIdentifier=/dev/nvme2n1
2026-01-22 00:38:20.605 + grep -v /dev/nvme2n1 /etc/fstab
2026-01-22 00:38:20.606 + mv /tmp/fstab /etc/fstab
2026-01-22 00:38:20.607 + '[' 1 == 0 ']'
2026-01-22 00:38:20.608 + active_devices+=($device)
2026-01-22 00:38:20.609 + (( idx = idx + 1 ))
2026-01-22 00:38:20.611 + encrypted_devices=($($INSTANCE_CONTROLLER_JAVA/java -cp $DISK_ENCRYPTOR_CP -Dlog4j2.configurationFile=file:$DISK_ENCRYPTOR_LOG4J2_CONFIG -Dlog4j2.formatMsgNoLookups=true -Dlog4j2.disable.jmx=true aws157.instancecontroller.encryptor.DiskEncryptorMain ${active_devices[*]}))
2026-01-22 00:38:20.612 ++ /usr/lib/jvm/jre-17/bin/java -cp '/usr/share/aws/emr/instance-controller/lib/*:/var/setup-devices/lib/*:/home/hadoop/conf:/usr/share/aws/aws-java-sdk-v2/*' -Dlog4j2.configurationFile=file:/etc/instance-controller/disk-encryptor-log4j2.xml -Dlog4j2.formatMsgNoLookups=true -Dlog4j2.disable.jmx=true aws157.instancecontroller.encryptor.DiskEncryptorMain /dev/nvme1n1p1 /dev/nvme1n1p2 /dev/nvme2n1
2026-01-22 00:38:25.422 SLF4J: Failed to load class "org.slf4j.impl.StaticLoggerBinder".
2026-01-22 00:38:25.423 SLF4J: Defaulting to no-operation (NOP) logger implementation
2026-01-22 00:38:25.424 SLF4J: See http://www.slf4j.org/codes.html#StaticLoggerBinder for further details.
2026-01-22 00:38:25.895 + make_xfs_parallel /dev/nvme1n1p1 /dev/nvme1n1p2 /dev/nvme2n1
2026-01-22 00:38:25.896 ++ printf '%s\n' /dev/nvme1n1p1 /dev/nvme1n1p2 /dev/nvme2n1
2026-01-22 00:38:25.897 + local 'devices=/dev/nvme1n1p1
2026-01-22 00:38:25.898 /dev/nvme1n1p2
2026-01-22 00:38:25.900 /dev/nvme2n1'
2026-01-22 00:38:25.902 ++ run_repeatedly 3 mktemp -t make_xfs_XXXXXXXXXX
2026-01-22 00:38:25.903 ++ (( i = 0 ))
2026-01-22 00:38:25.905 ++ (( i < 3 ))
2026-01-22 00:38:25.906 ++ mktemp -t make_xfs_XXXXXXXXXX
2026-01-22 00:38:25.907 ++ (( i++ ))
2026-01-22 00:38:25.908 ++ (( i < 3 ))
2026-01-22 00:38:25.909 ++ mktemp -t make_xfs_XXXXXXXXXX
2026-01-22 00:38:25.910 ++ (( i++ ))
2026-01-22 00:38:25.912 ++ (( i < 3 ))
2026-01-22 00:38:25.913 ++ mktemp -t make_xfs_XXXXXXXXXX
2026-01-22 00:38:25.914 ++ (( i++ ))
2026-01-22 00:38:25.915 ++ (( i < 3 ))
2026-01-22 00:38:25.916 + local 'log_files=/tmp/make_xfs_xmV7sI79KB
2026-01-22 00:38:25.917 /tmp/make_xfs_TTXrzYbRpX
2026-01-22 00:38:25.919 /tmp/make_xfs_y7tA9hCjBO'
2026-01-22 00:38:25.920 + local return_code=0
2026-01-22 00:38:25.921 + run_make_xfs_parallel '/dev/nvme1n1p1
2026-01-22 00:38:25.922 /dev/nvme1n1p2
2026-01-22 00:38:25.923 /dev/nvme2n1' '/tmp/make_xfs_xmV7sI79KB
2026-01-22 00:38:25.924 /tmp/make_xfs_TTXrzYbRpX
2026-01-22 00:38:25.925 /tmp/make_xfs_y7tA9hCjBO'
2026-01-22 00:38:25.926 + local 'devices=/dev/nvme1n1p1
2026-01-22 00:38:25.927 /dev/nvme1n1p2
2026-01-22 00:38:25.928 /dev/nvme2n1'
2026-01-22 00:38:25.930 + local 'log_files=/tmp/make_xfs_xmV7sI79KB
2026-01-22 00:38:25.931 /tmp/make_xfs_TTXrzYbRpX
2026-01-22 00:38:25.932 /tmp/make_xfs_y7tA9hCjBO'
2026-01-22 00:38:25.933 + timeout --kill-after=10 10 bash -c '{ date; udevadm monitor; }'
2026-01-22 00:38:25.934 + interleave_lines '/dev/nvme1n1p1
2026-01-22 00:38:25.935 /dev/nvme1n1p2
2026-01-22 00:38:25.936 /dev/nvme2n1' '/tmp/make_xfs_xmV7sI79KB
2026-01-22 00:38:25.937 /tmp/make_xfs_TTXrzYbRpX
2026-01-22 00:38:25.938 /tmp/make_xfs_y7tA9hCjBO'
2026-01-22 00:38:25.940 + xargs -r --verbose -P0 -L2 bash -xc '
2026-01-22 00:38:25.941       device=$0; log_file=$1
2026-01-22 00:38:25.942       { time mkfs.xfs -f "$device"; exit $?; } > "$log_file" 2>&1'
2026-01-22 00:38:25.943 ++ date +%Y-%m-%d-%H-%M-%S
2026-01-22 00:38:25.944 + paste '-d\n' /dev/fd/63 /dev/fd/62
2026-01-22 00:38:25.945 ++ echo '/dev/nvme1n1p1
2026-01-22 00:38:25.946 /dev/nvme1n1p2
2026-01-22 00:38:25.947 /dev/nvme2n1'
2026-01-22 00:38:25.948 ++ echo '/tmp/make_xfs_xmV7sI79KB
2026-01-22 00:38:25.949 /tmp/make_xfs_TTXrzYbRpX
2026-01-22 00:38:25.950 /tmp/make_xfs_y7tA9hCjBO'
2026-01-22 00:38:25.951 bash -xc ''$'\n''      device=$0; log_file=$1'$'\n''      { time mkfs.xfs -f "$device"; exit $?; } > "$log_file" 2>&1' /dev/nvme1n1p1 /tmp/make_xfs_xmV7sI79KB
2026-01-22 00:38:25.953 bash -xc ''$'\n''      device=$0; log_file=$1'$'\n''      { time mkfs.xfs -f "$device"; exit $?; } > "$log_file" 2>&1' /dev/nvme1n1p2 /tmp/make_xfs_TTXrzYbRpX
2026-01-22 00:38:25.954 bash -xc ''$'\n''      device=$0; log_file=$1'$'\n''      { time mkfs.xfs -f "$device"; exit $?; } > "$log_file" 2>&1' /dev/nvme2n1 /tmp/make_xfs_y7tA9hCjBO
2026-01-22 00:38:25.955 + device=/dev/nvme1n1p1
2026-01-22 00:38:25.956 + log_file=/tmp/make_xfs_xmV7sI79KB
2026-01-22 00:38:25.957 + device=/dev/nvme1n1p2
2026-01-22 00:38:25.958 + log_file=/tmp/make_xfs_TTXrzYbRpX
2026-01-22 00:38:25.959 + device=/dev/nvme2n1
2026-01-22 00:38:25.960 + log_file=/tmp/make_xfs_y7tA9hCjBO
2026-01-22 00:38:26.385 + echo 'Waiting for udev to settle'
2026-01-22 00:38:26.386 Waiting for udev to settle
2026-01-22 00:38:26.387 + udevadm settle
2026-01-22 00:38:26.445 + echo 'udevadmn settle finished'
2026-01-22 00:38:26.447 udevadmn settle finished
2026-01-22 00:38:26.448 + process_log_files '/tmp/make_xfs_xmV7sI79KB
2026-01-22 00:38:26.449 /tmp/make_xfs_TTXrzYbRpX
2026-01-22 00:38:26.450 /tmp/make_xfs_y7tA9hCjBO'
2026-01-22 00:38:26.451 + '[' -n '/tmp/make_xfs_xmV7sI79KB
2026-01-22 00:38:26.452 /tmp/make_xfs_TTXrzYbRpX
2026-01-22 00:38:26.454 /tmp/make_xfs_y7tA9hCjBO' ']'
2026-01-22 00:38:26.455 + echo '/tmp/make_xfs_xmV7sI79KB
2026-01-22 00:38:26.456 /tmp/make_xfs_TTXrzYbRpX
2026-01-22 00:38:26.457 /tmp/make_xfs_y7tA9hCjBO'
2026-01-22 00:38:26.458 + read -r log_file
2026-01-22 00:38:26.459 + sed 's#^#    #' /tmp/make_xfs_xmV7sI79KB
2026-01-22 00:38:26.461     + mkfs.xfs -f /dev/nvme1n1p1
2026-01-22 00:38:26.462     meta-data=/dev/nvme1n1p1         isize=512    agcount=8, agsize=163840 blks
2026-01-22 00:38:26.463              =                       sectsz=512   attr=2, projid32bit=1
2026-01-22 00:38:26.465              =                       crc=1        finobt=1, sparse=1, rmapbt=0
2026-01-22 00:38:26.466              =                       reflink=1    bigtime=1 inobtcount=1 nrext64=0
2026-01-22 00:38:26.467              =                       exchange=0  
2026-01-22 00:38:26.468     data     =                       bsize=4096   blocks=1310720, imaxpct=25
2026-01-22 00:38:26.469              =                       sunit=1      swidth=1 blks
2026-01-22 00:38:26.470     naming   =version 2              bsize=4096   ascii-ci=0, ftype=1, parent=0
2026-01-22 00:38:26.471     log      =internal log           bsize=4096   blocks=16384, version=2
2026-01-22 00:38:26.472              =                       sectsz=512   sunit=1 blks, lazy-count=1
2026-01-22 00:38:26.474     realtime =none                   extsz=4096   blocks=0, rtextents=0
2026-01-22 00:38:26.475     
2026-01-22 00:38:26.476     real	0m0.413s
2026-01-22 00:38:26.477     user	0m0.008s
2026-01-22 00:38:26.478     sys	0m0.000s
2026-01-22 00:38:26.479     + exit 0
2026-01-22 00:38:26.480 + rm /tmp/make_xfs_xmV7sI79KB
2026-01-22 00:38:26.481 + read -r log_file
2026-01-22 00:38:26.482 + sed 's#^#    #' /tmp/make_xfs_TTXrzYbRpX
2026-01-22 00:38:26.483     + mkfs.xfs -f /dev/nvme1n1p2
2026-01-22 00:38:26.484     meta-data=/dev/nvme1n1p2         isize=512    agcount=16, agsize=442352 blks
2026-01-22 00:38:26.485              =                       sectsz=512   attr=2, projid32bit=1
2026-01-22 00:38:26.486              =                       crc=1        finobt=1, sparse=1, rmapbt=0
2026-01-22 00:38:26.487              =                       reflink=1    bigtime=1 inobtcount=1 nrext64=0
2026-01-22 00:38:26.488              =                       exchange=0  
2026-01-22 00:38:26.489     data     =                       bsize=4096   blocks=7077627, imaxpct=25
2026-01-22 00:38:26.491              =                       sunit=1      swidth=1 blks
2026-01-22 00:38:26.492     naming   =version 2              bsize=4096   ascii-ci=0, ftype=1, parent=0
2026-01-22 00:38:26.493     log      =internal log           bsize=4096   blocks=16384, version=2
2026-01-22 00:38:26.494              =                       sectsz=512   sunit=1 blks, lazy-count=1
2026-01-22 00:38:26.495     realtime =none                   extsz=4096   blocks=0, rtextents=0
2026-01-22 00:38:26.496     
2026-01-22 00:38:26.497     real	0m0.480s
2026-01-22 00:38:26.498     user	0m0.009s
2026-01-22 00:38:26.499     sys	0m0.000s
2026-01-22 00:38:26.500     + exit 0
2026-01-22 00:38:26.501 + rm /tmp/make_xfs_TTXrzYbRpX
2026-01-22 00:38:26.503 + read -r log_file
2026-01-22 00:38:26.504 + sed 's#^#    #' /tmp/make_xfs_y7tA9hCjBO
2026-01-22 00:38:26.505     + mkfs.xfs -f /dev/nvme2n1
2026-01-22 00:38:26.506     meta-data=/dev/nvme2n1           isize=512    agcount=16, agsize=524288 blks
2026-01-22 00:38:26.507              =                       sectsz=512   attr=2, projid32bit=1
2026-01-22 00:38:26.508              =                       crc=1        finobt=1, sparse=1, rmapbt=0
2026-01-22 00:38:26.509              =                       reflink=1    bigtime=1 inobtcount=1 nrext64=0
2026-01-22 00:38:26.510              =                       exchange=0  
2026-01-22 00:38:26.511     data     =                       bsize=4096   blocks=8388608, imaxpct=25
2026-01-22 00:38:26.513              =                       sunit=1      swidth=1 blks
2026-01-22 00:38:26.514     naming   =version 2              bsize=4096   ascii-ci=0, ftype=1, parent=0
2026-01-22 00:38:26.515     log      =internal log           bsize=4096   blocks=16384, version=2
2026-01-22 00:38:26.516              =                       sectsz=512   sunit=1 blks, lazy-count=1
2026-01-22 00:38:26.518     realtime =none                   extsz=4096   blocks=0, rtextents=0
2026-01-22 00:38:26.519     
2026-01-22 00:38:26.520     real	0m0.362s
2026-01-22 00:38:26.521     user	0m0.009s
2026-01-22 00:38:26.522     sys	0m0.000s
2026-01-22 00:38:26.523     + exit 0
2026-01-22 00:38:26.524 + rm /tmp/make_xfs_y7tA9hCjBO
2026-01-22 00:38:26.525 + read -r log_file
2026-01-22 00:38:26.526 + return 0
2026-01-22 00:38:26.528 + emrDevice=/dev/nvme1n1p1
2026-01-22 00:38:26.529 + encrypted_devices=("${encrypted_devices[@]:1}")
2026-01-22 00:38:26.530 + create_devices_mount_map /dev/nvme1n1p1 /emr
2026-01-22 00:38:26.531 + local deviceFile=/dev/nvme1n1p1
2026-01-22 00:38:26.532 + local mount_point=/emr
2026-01-22 00:38:26.533 + echo /dev/nvme1n1p1
2026-01-22 00:38:26.534 + grep -qs /mapper
2026-01-22 00:38:26.536 ++ repeat_command_until_not_empty 'lsblk -o UUID -ipnd /dev/nvme1n1p1' 5
2026-01-22 00:38:26.537 ++ local 'cmd=lsblk -o UUID -ipnd /dev/nvme1n1p1'
2026-01-22 00:38:26.538 ++ local maxWait=5
2026-01-22 00:38:26.539 ++ local result=
2026-01-22 00:38:26.540 +++ date +%s
2026-01-22 00:38:26.541 ++ endTime=1769042311
2026-01-22 00:38:26.542 ++ '[' -z ']'
2026-01-22 00:38:26.543 +++ date +%s
2026-01-22 00:38:26.544 ++ '[' 1769042306 -lt 1769042311 ']'
2026-01-22 00:38:26.546 +++ bash -c 'lsblk -o UUID -ipnd /dev/nvme1n1p1'
2026-01-22 00:38:26.547 ++ result=b0a8ba28-3286-470d-95aa-8c50dbd5582c
2026-01-22 00:38:26.548 ++ '[' -z b0a8ba28-3286-470d-95aa-8c50dbd5582c ']'
2026-01-22 00:38:26.549 ++ printf b0a8ba28-3286-470d-95aa-8c50dbd5582c
2026-01-22 00:38:26.550 + local deviceUUID=b0a8ba28-3286-470d-95aa-8c50dbd5582c
2026-01-22 00:38:26.551 + '[' -z b0a8ba28-3286-470d-95aa-8c50dbd5582c ']'
2026-01-22 00:38:26.552 + create_drive b0a8ba28-3286-470d-95aa-8c50dbd5582c /emr
2026-01-22 00:38:26.553 + local deviceUUID=b0a8ba28-3286-470d-95aa-8c50dbd5582c
2026-01-22 00:38:26.554 + local drive=/emr
2026-01-22 00:38:26.555 + create_directory /emr
2026-01-22 00:38:26.556 + local dir=/emr
2026-01-22 00:38:26.557 + '[' -d /emr ']'
2026-01-22 00:38:26.558 + '[' -d /emr ']'
2026-01-22 00:38:26.559 + mount_drive b0a8ba28-3286-470d-95aa-8c50dbd5582c /emr
2026-01-22 00:38:26.560 + local deviceUUID=b0a8ba28-3286-470d-95aa-8c50dbd5582c
2026-01-22 00:38:26.561 + local mountPoint=/emr
2026-01-22 00:38:26.562 + lsblk -o UUID,MOUNTPOINT -ipnr
2026-01-22 00:38:26.563 + grep -
2026-01-22 00:38:26.564 + grep -qs '^b0a8ba28-3286-470d-95aa-8c50dbd5582c /emr$'
2026-01-22 00:38:26.565 + [[ /emr == \/\e\m\r ]]
2026-01-22 00:38:26.567 + mount -o inode64,nodev -t xfs UUID=b0a8ba28-3286-470d-95aa-8c50dbd5582c /emr
2026-01-22 00:38:26.568 + remove_fstab_entry b0a8ba28-3286-470d-95aa-8c50dbd5582c
2026-01-22 00:38:26.569 + local deviceIdentifier=b0a8ba28-3286-470d-95aa-8c50dbd5582c
2026-01-22 00:38:26.570 + grep -v b0a8ba28-3286-470d-95aa-8c50dbd5582c /etc/fstab
2026-01-22 00:38:26.571 + mv /tmp/fstab /etc/fstab
2026-01-22 00:38:26.572 + echo 'UUID=b0a8ba28-3286-470d-95aa-8c50dbd5582c /emr xfs defaults,noauto,comment=emr-setup-devices 0 0'
2026-01-22 00:38:26.573 + echo 'b0a8ba28-3286-470d-95aa-8c50dbd5582c /emr'
2026-01-22 00:38:26.574 + mntDevice=/dev/nvme1n1p2
2026-01-22 00:38:26.575 + encrypted_devices=("${encrypted_devices[@]:1}")
2026-01-22 00:38:26.576 + create_devices_mount_map /dev/nvme1n1p2 /mnt
2026-01-22 00:38:26.577 + local deviceFile=/dev/nvme1n1p2
2026-01-22 00:38:26.578 + local mount_point=/mnt
2026-01-22 00:38:26.579 + echo /dev/nvme1n1p2
2026-01-22 00:38:26.580 + grep -qs /mapper
2026-01-22 00:38:26.581 ++ repeat_command_until_not_empty 'lsblk -o UUID -ipnd /dev/nvme1n1p2' 5
2026-01-22 00:38:26.582 ++ local 'cmd=lsblk -o UUID -ipnd /dev/nvme1n1p2'
2026-01-22 00:38:26.584 ++ local maxWait=5
2026-01-22 00:38:26.585 ++ local result=
2026-01-22 00:38:26.586 +++ date +%s
2026-01-22 00:38:26.587 ++ endTime=1769042311
2026-01-22 00:38:26.588 ++ '[' -z ']'
2026-01-22 00:38:26.589 +++ date +%s
2026-01-22 00:38:26.591 ++ '[' 1769042306 -lt 1769042311 ']'
2026-01-22 00:38:26.592 +++ bash -c 'lsblk -o UUID -ipnd /dev/nvme1n1p2'
2026-01-22 00:38:26.593 ++ result=b70daf57-2d3f-43b7-a5f4-a9cc7988eb73
2026-01-22 00:38:26.594 ++ '[' -z b70daf57-2d3f-43b7-a5f4-a9cc7988eb73 ']'
2026-01-22 00:38:26.595 ++ printf b70daf57-2d3f-43b7-a5f4-a9cc7988eb73
2026-01-22 00:38:26.596 + local deviceUUID=b70daf57-2d3f-43b7-a5f4-a9cc7988eb73
2026-01-22 00:38:26.597 + '[' -z b70daf57-2d3f-43b7-a5f4-a9cc7988eb73 ']'
2026-01-22 00:38:26.598 + create_drive b70daf57-2d3f-43b7-a5f4-a9cc7988eb73 /mnt
2026-01-22 00:38:26.600 + local deviceUUID=b70daf57-2d3f-43b7-a5f4-a9cc7988eb73
2026-01-22 00:38:26.601 + local drive=/mnt
2026-01-22 00:38:26.602 + create_directory /mnt
2026-01-22 00:38:26.604 + local dir=/mnt
2026-01-22 00:38:26.605 + '[' -d /mnt ']'
2026-01-22 00:38:26.606 + '[' -d /mnt ']'
2026-01-22 00:38:26.607 + mount_drive b70daf57-2d3f-43b7-a5f4-a9cc7988eb73 /mnt
2026-01-22 00:38:26.609 + local deviceUUID=b70daf57-2d3f-43b7-a5f4-a9cc7988eb73
2026-01-22 00:38:26.610 + local mountPoint=/mnt
2026-01-22 00:38:26.611 + lsblk -o UUID,MOUNTPOINT -ipnr
2026-01-22 00:38:26.612 + grep -
2026-01-22 00:38:26.613 + grep -qs '^b70daf57-2d3f-43b7-a5f4-a9cc7988eb73 /mnt$'
2026-01-22 00:38:26.614 + [[ /mnt == \/\e\m\r ]]
2026-01-22 00:38:26.616 + mount -o inode64,nodev,usrquota,grpquota,prjquota -t xfs UUID=b70daf57-2d3f-43b7-a5f4-a9cc7988eb73 /mnt
2026-01-22 00:38:26.617 + remove_fstab_entry b70daf57-2d3f-43b7-a5f4-a9cc7988eb73
2026-01-22 00:38:26.618 + local deviceIdentifier=b70daf57-2d3f-43b7-a5f4-a9cc7988eb73
2026-01-22 00:38:26.619 + grep -v b70daf57-2d3f-43b7-a5f4-a9cc7988eb73 /etc/fstab
2026-01-22 00:38:26.620 + mv /tmp/fstab /etc/fstab
2026-01-22 00:38:26.621 + echo 'UUID=b70daf57-2d3f-43b7-a5f4-a9cc7988eb73 /mnt xfs defaults,noauto,comment=emr-setup-devices 0 0'
2026-01-22 00:38:26.623 + echo 'b70daf57-2d3f-43b7-a5f4-a9cc7988eb73 /mnt'
2026-01-22 00:38:26.624 + deviceIdx=1
2026-01-22 00:38:26.625 + for dev in "${encrypted_devices[@]}"
2026-01-22 00:38:26.626 + create_devices_mount_map /dev/nvme2n1 /mnt1
2026-01-22 00:38:26.627 + local deviceFile=/dev/nvme2n1
2026-01-22 00:38:26.628 + local mount_point=/mnt1
2026-01-22 00:38:26.629 + echo /dev/nvme2n1
2026-01-22 00:38:26.630 + grep -qs /mapper
2026-01-22 00:38:26.631 ++ repeat_command_until_not_empty 'lsblk -o UUID -ipnd /dev/nvme2n1' 5
2026-01-22 00:38:26.632 ++ local 'cmd=lsblk -o UUID -ipnd /dev/nvme2n1'
2026-01-22 00:38:26.633 ++ local maxWait=5
2026-01-22 00:38:26.634 ++ local result=
2026-01-22 00:38:26.635 +++ date +%s
2026-01-22 00:38:26.636 ++ endTime=1769042311
2026-01-22 00:38:26.637 ++ '[' -z ']'
2026-01-22 00:38:26.639 +++ date +%s
2026-01-22 00:38:26.640 ++ '[' 1769042306 -lt 1769042311 ']'
2026-01-22 00:38:26.641 +++ bash -c 'lsblk -o UUID -ipnd /dev/nvme2n1'
2026-01-22 00:38:26.642 ++ result=6d1202b3-82ab-481c-a331-c835d90189a7
2026-01-22 00:38:26.643 ++ '[' -z 6d1202b3-82ab-481c-a331-c835d90189a7 ']'
2026-01-22 00:38:26.644 ++ printf 6d1202b3-82ab-481c-a331-c835d90189a7
2026-01-22 00:38:26.645 + local deviceUUID=6d1202b3-82ab-481c-a331-c835d90189a7
2026-01-22 00:38:26.646 + '[' -z 6d1202b3-82ab-481c-a331-c835d90189a7 ']'
2026-01-22 00:38:26.647 + create_drive 6d1202b3-82ab-481c-a331-c835d90189a7 /mnt1
2026-01-22 00:38:26.648 + local deviceUUID=6d1202b3-82ab-481c-a331-c835d90189a7
2026-01-22 00:38:26.649 + local drive=/mnt1
2026-01-22 00:38:26.650 + create_directory /mnt1
2026-01-22 00:38:26.651 + local dir=/mnt1
2026-01-22 00:38:26.652 + '[' -d /mnt1 ']'
2026-01-22 00:38:26.653 + mkdir -p /mnt1
2026-01-22 00:38:26.654 + '[' -d /mnt1 ']'
2026-01-22 00:38:26.656 + mount_drive 6d1202b3-82ab-481c-a331-c835d90189a7 /mnt1
2026-01-22 00:38:26.657 + local deviceUUID=6d1202b3-82ab-481c-a331-c835d90189a7
2026-01-22 00:38:26.658 + local mountPoint=/mnt1
2026-01-22 00:38:26.659 + lsblk -o UUID,MOUNTPOINT -ipnr
2026-01-22 00:38:26.660 + grep -
2026-01-22 00:38:26.661 + grep -qs '^6d1202b3-82ab-481c-a331-c835d90189a7 /mnt1$'
2026-01-22 00:38:26.662 + [[ /mnt1 == \/\e\m\r ]]
2026-01-22 00:38:26.663 + mount -o inode64,nodev,usrquota,grpquota,prjquota -t xfs UUID=6d1202b3-82ab-481c-a331-c835d90189a7 /mnt1
2026-01-22 00:38:26.682 + remove_fstab_entry 6d1202b3-82ab-481c-a331-c835d90189a7
2026-01-22 00:38:26.683 + local deviceIdentifier=6d1202b3-82ab-481c-a331-c835d90189a7
2026-01-22 00:38:26.684 + grep -v 6d1202b3-82ab-481c-a331-c835d90189a7 /etc/fstab
2026-01-22 00:38:26.686 + mv /tmp/fstab /etc/fstab
2026-01-22 00:38:26.687 + echo 'UUID=6d1202b3-82ab-481c-a331-c835d90189a7 /mnt1 xfs defaults,noauto,comment=emr-setup-devices 0 0'
2026-01-22 00:38:26.689 + echo '6d1202b3-82ab-481c-a331-c835d90189a7 /mnt1'
2026-01-22 00:38:26.690 + (( deviceIdx = deviceIdx + 1 ))
2026-01-22 00:38:26.691 + tee -a /dev/console
2026-01-22 00:38:26.694 ++ date
2026-01-22 00:38:26.695 + echo 'Drives setup completed at: Thu' Jan 22 00:38:26 UTC 2026
2026-01-22 00:38:26.696 Drives setup completed at: Thu Jan 22 00:38:26 UTC 2026
2026-01-22 00:38:26.698 + echo 'Currently mounted devices: '
2026-01-22 00:38:26.699 + tee -a /dev/console
2026-01-22 00:38:26.700 Currently mounted devices: 
2026-01-22 00:38:26.701 + df
2026-01-22 00:38:26.702 + tee -a /dev/console
2026-01-22 00:38:26.703 Filesystem       1K-blocks    Used Available Use% Mounted on
2026-01-22 00:38:26.704 devtmpfs              4096       0      4096   0% /dev
2026-01-22 00:38:26.705 tmpfs              8078904       0   8078904   0% /dev/shm
2026-01-22 00:38:26.706 tmpfs              3231564    8604   3222960   1% /run
2026-01-22 00:38:26.707 /dev/nvme0n1p1    15650796 7156072   8494724  46% /
2026-01-22 00:38:26.708 /dev/nvme0n1p128     10202    1314      8888  13% /boot/efi
2026-01-22 00:38:26.709 /dev/nvme1n1p1     5177344   69368   5107976   2% /emr
2026-01-22 00:38:26.710 /dev/nvme1n1p2    28244972  230756  28014216   1% /mnt
2026-01-22 00:38:26.711 /dev/nvme2n1      33488896  267356  33221540   1% /mnt1
2026-01-22 00:38:26.712 
2026-01-22 00:38:26.714 real	0m7.304s
2026-01-22 00:38:26.715 user	0m2.797s
2026-01-22 00:38:26.716 sys	0m0.222s
